<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>reslr: Statistical Models for examining Relative Sea Level Change in R • reslr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="reslr: Statistical Models for examining Relative Sea Level Change in R">
<meta property="og:description" content="reslr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reslr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/reslr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced_reslr.html">reslr: advanced</a>
    </li>
    <li>
      <a href="../articles/quick_start.html">reslr: quick start guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maeveupton/reslr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>reslr: Statistical Models for examining Relative
Sea Level Change in R</h1>
                        <h4 data-toc-skip class="author">Maeve Upton,
Andrew Parnell &amp; Niamh Cahill</h4>
            
            <h4 data-toc-skip class="date">2023-06-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/maeveupton/reslr/blob/HEAD/vignettes/reslr.Rmd" class="external-link"><code>vignettes/reslr.Rmd</code></a></small>
      <div class="hidden name"><code>reslr.Rmd</code></div>

    </div>

    
    
<!-- avoid border around images -->
<style>
  img {
    border: 0;
  }
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>If you require fast instructions, check out the reslr: <a href="https://maeveupton.github.io/reslr/articles/quick_start.html" class="external-link">Quick
start</a>.</p>
<p>The <code>reslr</code> package is specifically developed for Bayesian
modeling of relative sea-level data. It offers a diverse selection of
statistical models, including linear regression, change-point
regression, integrated Gaussian process regression, splines, and
generalized additive models. One notable feature is the incorporation of
measurement uncertainty in multiple dimensions, which is crucial when
analyzing relative sea-level data. The package provides a unified
framework for data loading, model fitting, and summarising changes in
relative sea level (RSL) over time and space. The generated plots depict
sea level curves and corresponding rates of change, taking into account
the associated uncertainty.</p>
<p>There are a number of modelling options available to the user:</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="53%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th>Statistical Model</th>
<th>Model Information</th>
<th>
<code>model_type</code> code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Errors in variables simple linear regression</td>
<td>A straight line of best fit taking account of any age and
measurement errors in the RSL values using the method of Cahill et al
(2015)</td>
<td><strong>“eiv_slr_t”</strong></td>
</tr>
<tr class="even">
<td>Errors in variables change point model</td>
<td>An extension of the linear regression modelling process. It uses
piece-wise linear sections and estimates where/when trend changes occur
in the data (Cahill et al. 2015).</td>
<td><strong>“eiv_cp_t”</strong></td>
</tr>
<tr class="odd">
<td>Errors in variables integrated Gaussian Process</td>
<td>A non linear fit that utilities a Gaussian process prior on the rate
of sea-level change that is then integrated (Cahill et al. 2015).</td>
<td><strong>“eiv_igp_t”</strong></td>
</tr>
<tr class="even">
<td>Noisy Input spline in time</td>
<td>A non-linear fit using regression splines using the method of Upton
et al (2023).</td>
<td><strong>“ni_spline_t”</strong></td>
</tr>
<tr class="odd">
<td>Noisy Input spline in space and time</td>
<td>A non-linear fit for a set of sites across a region using the method
of Upton et al (2023).</td>
<td><strong>“ni_spline_st”</strong></td>
</tr>
<tr class="even">
<td>Noisy Input Generalised Additive model for the decomposition of the
RSL signal</td>
<td>A non-linear fit for a set of sites across a region and provides a
decomposition of the signal into regional, local-linear (commonly GIA)
and local non-linear components. Again this full model is as described
in Upton et al (2023).</td>
<td><strong>“ni_gam_decomp”</strong></td>
</tr>
</tbody>
</table>
<p>For all of the above models the user is able to quantify and
visualise changes of RSL and rates of change with associated
uncertainties. Indeed a full posterior distribution ensemble of values
is available in the output of the functions. For the decomposed full
model, <strong>“ni_gam_decomp”</strong>, the user is able to access the
posterior probability distributions of the individual components.</p>
</div>
<div class="section level2">
<h2 id="installation-of-the-reslr-package">Installation of the <code>reslr</code> package<a class="anchor" aria-label="anchor" href="#installation-of-the-reslr-package"></a>
</h2>
<p>The <code>reslr</code> package uses the JAGS (Just Another Gibbs
Sampler) software to run the models. Before installing
<code>reslr</code>, visit the <a href="https://sourceforge.net/projects/mcmc-jags/" class="external-link">JAGS</a> website and
download and install JAGS for your operating system.</p>
<p>Next, start Rstudio and find the window with the command prompt (the
symbol <code>&gt;</code>). Type</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("reslr")</span></span>
<span><span class="co"># library(devtools)</span></span>
<span><span class="co"># devtools::install()</span></span>
<span><span class="co">#devtools::install_github("maeveupton/reslr")</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"maeveupton/reslr"</span><span class="op">)</span></span></code></pre></div>
<p>It may ask you to pick your nearest CRAN mirror (the nearest site
which hosts R packages). You will then see some activity on the screen
as the <code>reslr</code> package and the other packages it uses are
downloaded. The final line should then read:</p>
<p><code>package 'reslr' successfully unpacked and MD5 sums checked</code></p>
<p>You then need to load the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/maeveupton/reslr" class="external-link">reslr</a></span><span class="op">)</span></span></code></pre></div>
<p>This will load the <code>reslr</code> package and all the associated
packages. You’ll need to type the <code><a href="https://github.com/maeveupton/reslr" class="external-link">library(reslr)</a></code> command
every time you start R. If you have problems, visit the <a href="https://github.com/maeveupton/reslr/issues" class="external-link">Issues</a> page and
leave a message to tell us what went wrong.</p>
</div>
<div class="section level2">
<h2 id="considerations-before-running-reslr">Considerations before running reslr<a class="anchor" aria-label="anchor" href="#considerations-before-running-reslr"></a>
</h2>
<p>Prior to running the <code>reslr</code> package, there are a few
points to consider.</p>
<div class="section level3">
<h3 id="installating-jags-software">Installating JAGS software<a class="anchor" aria-label="anchor" href="#installating-jags-software"></a>
</h3>
<p>In this package, the models are written using Just Another Gibbs
Sample (JAGS) which uses Gibbs sampling and Markov Chain Monte Carlo
(MCMC) algorithm to draw samples from the posterior distribution of the
unknown parameters. To download the JAGS package use this <a href="https://sourceforge.net/projects/mcmc-jags/" class="external-link">link</a>.</p>
</div>
<div class="section level3">
<h3 id="working-with-scripts">Working with scripts<a class="anchor" aria-label="anchor" href="#working-with-scripts"></a>
</h3>
<p>The best way to use the <code>reslr</code> package is by creating
scripts. A script can be created in Rstudio by clicking
<code>File &gt; New File &gt; Rscript</code>. This opens a text window
which allows commands to be typed in order and saved. The command can be
sent to the command prompt (which Rstudio calls the Console) by
highlighting the command and clicking Run (or going to Code &gt; Run
Lines). There are also keyboard shortcuts to speed up the process. We
strongly recommend you learn to run R via scripts.</p>
</div>
<div class="section level3">
<h3 id="inputting-users-data">Inputting User’s data<a class="anchor" aria-label="anchor" href="#inputting-users-data"></a>
</h3>
<p><code>reslr</code> can handle three different types of data
structure. It is important to note that varying the number of data sites
will require different statistical modelling strategy:</p>
<ul>
<li>A single site. This may occur when you have data for only one
individual data site. In the case of a single site, we recommend using a
temporal model, for example EIV Integrated Gaussian Process or NI spline
in time.</li>
<li>Multiple sites. This may occur if you have a dataset which has
multiple different data sites. In this situation, the user must use a
spatial temporal model, for example NI spline in space time.</li>
<li>Multiple group of sites with different drivers of change. This may
occur if you have multiple locations are interested in investigating how
the regional, linear local and non-linear local components vary. In this
case, the NI GAM decomposition is recommended.</li>
</ul>
<p>The user must ensure that the input data is a dataframe. For a single
site or multiple sites only one dataframe should be given to the
package, i.e. combined all sites into one dataframe, with the following
columns names:</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="8%">
<col width="10%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="6%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th>Site</th>
<th>Region</th>
<th>Age</th>
<th>Age_err</th>
<th>RSL</th>
<th>RSL_err</th>
<th>Longitude</th>
<th>Latitude</th>
<th>linear_rate</th>
<th>linear_rate_err</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>“Leeds Point”</td>
<td>“New Jersey”</td>
<td>1000</td>
<td>8</td>
<td>0.5</td>
<td>0.01</td>
<td>39.5</td>
<td>- 74.4</td>
<td>1.69</td>
<td>0.03</td>
<td></td>
</tr>
<tr class="even">
<td>“Leeds Point”</td>
<td>“New Jersey”</td>
<td>1050</td>
<td>11</td>
<td>0.6</td>
<td>0.01</td>
<td>39.5</td>
<td>- 74.4</td>
<td>1.69</td>
<td>0.03</td>
<td></td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td></td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td></td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td></td>
</tr>
<tr class="even">
<td>“Cedar Island”</td>
<td>“North Carolina”</td>
<td>1700</td>
<td>12</td>
<td>0.8</td>
<td>0.06</td>
<td>-76.4</td>
<td>35</td>
<td>0.74</td>
<td>0.01</td>
<td></td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td></td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><p>Site is the name of the site in question, e.g. Leeds
Point.</p></li>
<li><p>Region is the area in which is was collected, e.g. New Jersey. To
note, in the package, the Site and the Region columns will be combined
to form a factor called the <code>SiteName</code> which results in an
output, e.g. “Leeds Point,New Jersey”.</p></li>
<li><p>Age is the year of the data in Common era (“CE”) or Before
Present (“BP”). If calibrated in the BP form the package will convert
the data into the Common Era form.</p></li>
<li><p>Age_err is the 1 standard deviation (<span class="math inline">\(\sigma\)</span>) Age uncertainty associated with
the Age.</p></li>
<li><p>RSL is the Relative Sea Level measured in meters.</p></li>
<li><p>RSL_err is the 1 standard deviation (<span class="math inline">\(\sigma\)</span>) Relative Sea level uncertainty
associated with the RSL measured in meters.</p></li>
<li><p>Longitude is the longitude of the site in degrees (in decimal,
range: -180 to 180). It is important to note that if there are slightly
different longitude values for all the observations in site this will
lead to errors. Therefore, select one longitude value for each
site.</p></li>
<li><p>Latitude is the Latitude of the site in degrees (degree in
decimal, range -90 to 90). Similarly, it is important to note that if
there are slightly different latitude values for all the observations in
site this will lead to errors. Therefore, select one latitude value for
each site.</p></li>
<li><p><strong>Optional</strong> linear_rate is a column that contains
the linear rate in mm per year associated with that site, arising from
processes such as glacial isostatic adjustment (GIA). <em>This is not a
requirement</em>. For the NI GAM decomposition model, the user has the
option of using their own rate, otherwise the package will calculate it
using the data. It is important to note that if the linear_rate is
provided without the linear_rate_err column this will lead to issues,
i.e. both columns need to be provided</p></li>
<li><p><strong>Optional</strong> linear_rate_err is a column that
contains associated uncertainty for the linear rate in mm per year.
<em>This is not a requirement</em>. For the NI GAM decomposition model,
the user has the option of using their value, otherwise the package will
calculate it using the data. It is important to note that if the
linear_rate_err is provided without the linear_rate column this will
lead to issues, i.e. both columns need to be provided.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="tide-gauge-data">Tide Gauge Data<a class="anchor" aria-label="anchor" href="#tide-gauge-data"></a>
</h3>
<p>There is an option in the <code>reslr</code> package to include tide
gauge data as an additional source of data which we recommend when using
the <code>model_type = "ni_gam_decomp"</code>. The package will extract
tide gauge data from the <a href="https://psmsl.org/data/obtaining/complete.php" class="external-link">PSMSL website</a>.
The data is downloaded from this website and stored in a temporary
directory.</p>
<p>The tide gauges undergo a number of processing steps within the
package. Firstly, certain tide gauges have been flagged by the PSMSL
website and we remove these locations. Secondly, the tide gauge data in
the PSMSL database is given in millimetres relative to a revised local
reference datum (a coordinate system which defines the zero level for
sea level measurements (Pugh et al., 2014)). We transform the data by
removing 7000 mm to revert the tide gauge data into the observed
reference frame and convert the RSL to metres following the PSMSL
guidance as described in Aarup et al. 2006 . Lastly, the tide gauge data
is averaged over a decade to make it comparable with sedimentation rates
associated proxy records sedimentation rates. The user can alter the
size of the average if required when accumulation rates for the sediment
in the proxy record is estimated to have a higher or lower accumulation
rate, e.g. longer sediment accumulation rate result in a larger window
average of 20 years.</p>
<p>Within the <code>reslr_load</code> function, the user has three
options to choose from:</p>
<ol style="list-style-type: decimal">
<li><p>Provide a list of the preferred tide gauges from the <a href="https://psmsl.org/data/obtaining/" class="external-link">PSMSL website</a>, ensuring
spelling, capitalisation and spacing is exactly the same as the website.
Note, the package will not work if error in spelling occurs. In
addition, certain tide gauges have been flagged by the PSMSL website and
are not included in this package and will return an error if selected.
This is done by giving a list to the
<code>list_preferred_TGs = c("ARGENTIA","MAYPORT")</code> option in the
<code>reslr_mcmc</code> function</p></li>
<li><p>The nearest tide gauge to proxy site based on minimum distance in
kilometers, which is done by setting
<code>TG_minimum_dist_proxy = TRUE</code>.</p></li>
<li><p>Any tide gauge within 1 degree from the proxy site, which is done
by setting <code>all_TG_1deg = TRUE</code>.</p></li>
</ol>
<p>The user can select a combination of option 1 and option 2 or option
1 and option 3 which allows for additional tide gauge data to be
included. The final output is a data frame which contains an additional
column, called <code>data_type_id</code>, identifying the data source
“ProxyRecord” or “TideGaugeData” depending on the observation in
question.</p>
</div>
<div class="section level3">
<h3 id="glacial-isostatic-adjustment-gia">Glacial Isostatic Adjustment (GIA)<a class="anchor" aria-label="anchor" href="#glacial-isostatic-adjustment-gia"></a>
</h3>
<p>For the NI GAM decomposition, the statistical model requires an
estimate for the local linear rate arising from processes such as GIA
and associated uncertainty for this rate each site. According to
Whitehouse (2018), GIA represents the Earth’s reaction to the growth or
melting of ice sheets, including the gravitational field and ocean. GIA
can be approximated as a linear contribution over a short timescale, but
with variable effects along the coast (Engelhart et al., 2009).
Earth-ice models, which incorporate the physical structure of the Earth
to predict GIA changes due to ice loading and unloading, can provide
estimates of GIA rates. There are a range of Earth-ice models with one
such example being the ICE5G VM2-90 (Peltier, 2004). It should be noted
that other processes, such as tectonic vertical land motion, can mimic
the linear trend of GIA. Therefore, the linear local component within
the NI GAM decomposition may account for contributions from processes
other than GIA that drive changes in relative sea level. These are
included as additional columns, <code>linear_rate</code> and
<code>linear_rate_err</code>, in the input dataframe provided by the
user.</p>
<p>If the GIA rate for the proxy site is not provided then package will
automatically calculate these rates using the data provided and we do
not estimates the rates from any Earth-ice physical model. The user can
source their own rate estimates as previously mentioned. Two examples of
GIA rate sources (not limited to) include <a href="https://www.physics.utoronto.ca/members/peltier-w-richard/" class="external-link">Prof. Peltier’s
webpage</a> and the associated publication (Peltier, 2004) or the Caron
et al. 2018 publication and <a href="https://vesl.jpl.nasa.gov/solid-earth/gia/" class="external-link">data</a>.</p>
<p>Important to note, the tide gauge data require values for the
<code>linear_rate</code> and <code>linear_rate_err</code> columns. This
is calculated using ICE-5G (VM2 L90) Earth ice model (Peltier et
al. 2004) with an uncertainty value of 0.3 mm/year from Engelhart et
al. 2009.</p>
</div>
<div class="section level3">
<h3 id="example-data-set">Example Data Set<a class="anchor" aria-label="anchor" href="#example-data-set"></a>
</h3>
<p>The <code>reslr</code> package possesses a large dataset used as an
example called <code>NAACproxydata</code>. This dataset contains proxy
records from the Atlantic coast of North America as used in Upton et al
2023 along with tide gauge data which will be discussed below. The 21
different proxy data sites and the references for each data source can
be found in the following table:</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Site Name</th>
<th>Reference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Barn Island, Connecticut</td>
<td>Donnelly et al (2004), Gehrels et al (2020)</td>
</tr>
<tr class="even">
<td>Big River Marsh, Newfoundland</td>
<td>Kemp et al (2018)</td>
</tr>
<tr class="odd">
<td>Cape May Courthouse, New Jersey</td>
<td>Kemp et al (2013), Cahill et al (2016)</td>
</tr>
<tr class="even">
<td>Cedar Island, North Carolina</td>
<td>Kemp et al (2011), Kemp et al (2017)</td>
</tr>
<tr class="odd">
<td>Cheesequake, New Jersey</td>
<td>Walker et al (2021)</td>
</tr>
<tr class="even">
<td>Chezzetcook Inlet, Nova Scotia</td>
<td>Gehrels et al (2020)</td>
</tr>
<tr class="odd">
<td>East River Marsh, Connecticut</td>
<td>Kemp et al (2015), Stearns et al (2023)</td>
</tr>
<tr class="even">
<td>Fox Hill Marsh, Rhode Island</td>
<td>Stearns et al (2023)</td>
</tr>
<tr class="odd">
<td>Leeds Point, New Jersey</td>
<td>Kemp et al (2013), Cahill et al (2016)</td>
</tr>
<tr class="even">
<td>Les Sillons, Magdelen Islands</td>
<td>Barnett et al (2017)</td>
</tr>
<tr class="odd">
<td>Little Manatee River, Florida</td>
<td>Gerlach et al (2017)</td>
</tr>
<tr class="even">
<td>Nassau, Florida</td>
<td>Kemp et al (2014)</td>
</tr>
<tr class="odd">
<td>Pelham Bay, New York</td>
<td>Kemp et al (2017), Stearns et al (2017)</td>
</tr>
<tr class="even">
<td>Placentia, Newfoundland</td>
<td>Kemp et al (2018)</td>
</tr>
<tr class="odd">
<td>Revere, Massachusetts</td>
<td>Donnelly et al (2006)</td>
</tr>
<tr class="even">
<td>Saint Simeon, Quebec</td>
<td>Barnett et al (2017)</td>
</tr>
<tr class="odd">
<td>Sanborn Cove, Maine</td>
<td>Gehrels et al (2020)</td>
</tr>
<tr class="even">
<td>Sand Point, North Carolina</td>
<td>Kemp et al (2011), Kemp et al (2017)</td>
</tr>
<tr class="odd">
<td>Snipe Key, Florida</td>
<td>Khan et al (2022)</td>
</tr>
<tr class="even">
<td>Swan Key, Florida</td>
<td>Khan et al (2022)</td>
</tr>
<tr class="odd">
<td>Wood Island, Massachusetts</td>
<td>Kemp et al (2011)</td>
</tr>
</tbody>
</table>
<p>The <code>NAACproxydata</code> is a data frame with 1715 rows and 8
columns which include:</p>
<ul>
<li>Region: All regions along Atlantic coast of North America</li>
<li>Site: All sites along Atlantic coast of North America</li>
<li>Latitude: Latitude of the data site</li>
<li>Longitude: Longitude of the data site</li>
<li>RSL: Relative Sea level in meters</li>
<li>RSL_err: 1 standard deviation error associated with relative sea
level measured in meters</li>
<li>Age: Age in years common era (CE)</li>
<li>Age_err: 1 standard deviation error associated with the Age in years
CE</li>
</ul>
<p>If you are interested in a specific site or multiple sites from the
example dataset, then filter for that site prior to running the package,
using the following method:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 1 site</span></span>
<span><span class="va">data_1site</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="va"><a href="../reference/NAACproxydata.html">NAACproxydata</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"Cedar Island"</span><span class="op">)</span></span>
<span><span class="co"># For multiple sites</span></span>
<span><span class="va">data_multisite</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="va"><a href="../reference/NAACproxydata.html">NAACproxydata</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Snipe Key"</span>, <span class="st">"Cheesequake"</span>,</span>
<span>  <span class="st">"Placentia"</span>, <span class="st">"Leeds Point"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="how-to-run-reslr">How to run reslr<a class="anchor" aria-label="anchor" href="#how-to-run-reslr"></a>
</h2>
<p>The general structure for running <code>reslr</code> is as
follows:</p>
<p><strong>Step 1.</strong> Load in the data using
<code>reslr_load</code>. If tide gauge data is required update the
argument <code>include_tide_gauge = TRUE</code>, from this the user has
three options as described above. First, provide the list of names for
the tide gauges from PSMSL website that the wish to use in the
<code>list_preferred_TGs</code> option. Second, the package find the
tide gauge closest to the proxy site
<code>TG_minimum_dist_proxy = TRUE</code>. Third, the package uses all
tide gauges within 1 degree of the proxy site
<code>all_TG_1deg = TRUE</code>. If sedimentation accumulation rates for
the proxy records are less than or greater than a decade the user can
alter this size using <code>sediment_average_TG = 10</code> which has a
default of 10 years. If linear_rate is of interest to the user update
the argument <code>include_linear_rate = TRUE</code>. The user can
select the resolution of the output by changing the value of
<code>prediction_grid_res = 50</code> with the default of 50 years. The
<code>input_age_type</code> argument is associated with the type of
input age where the default is in Common Era. The package can model
Before Present by updating this setting to “BP” and more information is
in the advanced vignette.</p>
<p><strong>Step 1a.</strong> The <code>print</code> function provides a
brief insight into the inputted data.</p>
<p><strong>Step 2.</strong> Plot the raw data using <code>plot</code>
and select whether to include tide gauges in the output plot. The user
can update the title (<code>plot_title</code>) and axis labels
(<code>xlab</code>,<code>ylab</code>). The captions
(<code>plot_captions</code>) can be included on the plots which provides
a summary of the number of proxy sites and tide gauge sites.</p>
<p><strong>Step 3.</strong> Choose your preferred model type from the
available list above and use the <code>reslr_mcmc</code> function to
obtain the parameter estimates and the dataframes required for plotting
the outputs. This function has a number of settings which allow the user
to improve model diagnostics. In addition, this function allows the user
to chose their preferred credible interval size, the default setting is
<code>CI = 0.95</code>.</p>
<p><strong>Step 3a.</strong> The <code>print</code> function provides a
brief insight into the output of the <code>reslr_mcmc</code>
function.</p>
<p><strong>Step 4.</strong> Check the model converged and examine the
results of the parameters with the <code>summary</code> function</p>
<p><strong>Step 5.</strong> Visualise the results with <code>plot</code>
and access the dataframes used to create the plots. The
<code>plot_type</code> option allows users to print individual plots,
for example the model fits (“model_fit_plot”) and the rates
(“rate_plot”) separately. The captions (<code>plot_captions</code>) can
be included on the plots which provides a summary of the model type, the
number of proxy sites and tide gauge sites. The user can select to
include the tide gauge (<code>plot_tide_gauges</code>) in the output
plots.</p>
</div>
<div class="section level2">
<h2 id="errors-in-variables-simple-linear-regression-eiv_slr_t">Errors-in-Variables Simple Linear Regression
(<strong>“eiv_slr_t”</strong>)<a class="anchor" aria-label="anchor" href="#errors-in-variables-simple-linear-regression-eiv_slr_t"></a>
</h2>
<p>The simplest model the <code>reslr</code> package can fit is a simple
linear regression using the Errors-in-Variables method to account for
the uncertainty associated with the proxy records, i.e. uncertainty
associated with input (age) and the output (RSL). We would not recommend
any model simpler than this (e.g. <code>lm</code>) as it will ignore
some of the key uncertainties in the data.</p>
<p>This technique focuses on 1 site and is not recommended for multiple
proxy sites together. Tide gauge data can be included to gain insight
into recent changes in RSL, however, the user must investigate which
tide gauge is suitable. As an example, we will filter the example
dataset <code>NAACproxydata</code> to select one site to demonstrate the
process:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 1 site</span></span>
<span><span class="va">CedarIslandNC</span> <span class="op">&lt;-</span> <span class="va">NAACproxydata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"Cedar Island"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 1:</strong> Load in the data using the
<code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CedarIslandNC_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">CedarIslandNC</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  input_age_type <span class="op">=</span> <span class="st">"CE"</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this function, the user can select to add tide gauge data and
estimates for linear_rate, by changing
<code>include_tide_gauge = TRUE</code> and
<code>include_linear_rate = TRUE</code> respectfully. If
<code>include_tide_gauge = TRUE</code> the user must decide if they
require the closest tide gauge
i.e. <code>TG_minimum_dist_proxy = TRUE</code>, or select specific tide
gauge i.e. <code>list_preferred_TGs = c("ARGENTIA")</code>, or all tide
gauges within 1 degree of the proxy site
i.e. <code>all_TG_1deg = TRUE</code>. The default setting is
<code>rolling_window_average = 10</code> which corresponds to sediment
accumulation rates of the proxy records, yet the user has the ability to
alter this sediment accumulation rate. Note that for a simple linear
regression we recommend using the default settings as demonstrated in
the above code chunk. The user can alter the resolution of the output
plots using <code>prediction_grid_res</code> with the default set at 50
years.</p>
<p>The output of this function is a list of two dataframes called
<code>data</code> and <code>data_grid</code>.</p>
<ul>
<li>The <code>data</code> dataframe is the inputted data with additional
columns for the linear_rate, linear_rate_err and data_type_id which will
contain two options, “ProxyRecord” or “TideGaugeData”. It can be
accessed by:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<ul>
<li>The <code>data_grid</code> is a dataframe that is evenly spaced in
time based on the <code>prediction_grid_res</code> value chosen by the
user and is used to create the plots and is accessed by</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grid</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data_grid</span></span></code></pre></div>
<p><strong>Step 1a:</strong> A brief insight into the outputs of the
<code>reslr_input</code> function can be obtained using:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr input object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Decadally averaged tide gauge data was not included. It is recommended for the ni_gam_decomp model </span></span>
<span><span class="co">#&gt; The linear_rate or linear_rate_err was not included. It is required for the ni_gam_decomp model</span></span></code></pre></div>
<p><strong>Step 2:</strong> Plotting the data the raw data with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_caption <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotdata-1.png" width="672" style="display: block; margin: auto;">
This will produce a plot of Age on the x-axis and Relative Sea Level on
the y-axis in meters. Grey boxes represent the uncertainty associated
with the vertical and horizontal uncertainty. The black data points are
the midpoints of these uncertainty boxes. The following extra arguments
can be used which allows the user to updated the titles and axis labels.
The caption <code>plot_caption</code>, included by default, provides the
number of proxy sites and tide gauge sites that will be used in the
model and can be removed if required <code>plot_caption = FALSE</code>.
In addition, the user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code>.</p>
<p><strong>Step 3:</strong> To run the the model the following code is
used:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_slr_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_slr_t"</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; module glm loaded</span></span>
<span><span class="co">#&gt; Compiling model graph</span></span>
<span><span class="co">#&gt;    Resolving undeclared variables</span></span>
<span><span class="co">#&gt;    Allocating nodes</span></span>
<span><span class="co">#&gt; Graph information:</span></span>
<span><span class="co">#&gt;    Observed stochastic nodes: 208</span></span>
<span><span class="co">#&gt;    Unobserved stochastic nodes: 107</span></span>
<span><span class="co">#&gt;    Total graph size: 997</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initializing model</span></span></code></pre></div>
<p>This command takes the input data and the user specifies the
statistical model, i.e. a simple linear regression using the EIV
uncertainty method (“eiv_slr_t”). The <code>CI</code> setting allows the
user to set the credible intervals, the current default is
<code>CI = 0.95</code>. The function tells <code>reslr</code> to store
the output of the model run in an object called
<code>res_eiv_slr_t</code>.</p>
<p><strong>Step 3a:</strong> A brief insight into the outputs of the
<code>reslr_output</code> function can be obtained using:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_eiv_slr_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr output object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; The model used was the Errors-in-Variables Simple Linear Regression model.</span></span>
<span><span class="co">#&gt; The input data has been run via reslr_mcmc and has produced 3000 iterations over 3 MCMC chains.</span></span></code></pre></div>
<p><strong>Step 4:</strong> The convergence of the algorithm is examined
and he parameter estimates from the model can be investigated using the
following:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_eiv_slr_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; No convergence issues detected.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 7</span></span></span>
<span><span class="co">#&gt;   variable    mean      sd     mad      q5     q95  rhat</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> alpha    -<span style="color: #BB0000;">1.99</span>   0.017<span style="text-decoration: underline;">2</span>  0.017<span style="text-decoration: underline;">4</span>  -<span style="color: #BB0000;">2.02</span>   -<span style="color: #BB0000;">1.96</span>    1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> beta      0.823  0.013<span style="text-decoration: underline;">1</span>  0.013<span style="text-decoration: underline;">1</span>   0.802   0.845   1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sigma_y   0.066<span style="text-decoration: underline;">7</span> 0.009<span style="text-decoration: underline;">63</span> 0.009<span style="text-decoration: underline;">46</span>  0.050<span style="text-decoration: underline;">9</span>  0.082<span style="text-decoration: underline;">6</span>  1.00</span></span></code></pre></div>
<p>If the model run has the package will print: “No convergence issues
detected”. If the package prints: “Convergence issues detected, a longer
run is necessary”. The user is required to update the
<code>reslr_mcmc</code> function with additional iterations in the
following manner:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_slr_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_slr_t"</span>,</span>
<span>  <span class="co"># Update these values</span></span>
<span>  n_iterations <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># Number of iterations</span></span>
<span>  n_burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of iterations to discard at the beginning</span></span>
<span>  n_thin <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Reduces number of output samples to save memory and computation time</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of Markov chains</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output of this function allows to user to examine the parameter
estimates. For the eiv_slr_t model, the parameters of interest are the
intercept (“alpha”), the slope (“beta”) and the residual standard
deviation of the model (“sigma_y”). When using the eiv_slr_t model, an
estimate of the of the rate of sea-level change can be obtained by
examining the value of the slope, i.e. “beta”.</p>
<p><strong>Step 5:</strong> The results from the eiv_slr_t model can be
visualised using the following function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_eiv_slr_t</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotslrres-1.png" width="672" style="display: block; margin: auto;">
The output of this function is a graph of the input data, i.e. Age and
RSL and associated uncertainty boxes, and the model fit with 95 %
credible interval. The caption provides the model type used and number
of proxy sites and tide gauge sites used and can be removed if necessary
with <code>plot_caption = FALSE</code>.</p>
<p>To examine the data creating these plots the user types the
following:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_dataframes</span> <span class="op">&lt;-</span> <span class="va">res_eiv_slr_t</span><span class="op">$</span><span class="va">output_dataframes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output_dataframes</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Longitude Latitude                       SiteName data_type_id     Age</span></span>
<span><span class="co">#&gt; 1    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -734.75</span></span>
<span><span class="co">#&gt; 2    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -650.00</span></span>
<span><span class="co">#&gt; 3    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -600.00</span></span>
<span><span class="co">#&gt; 4    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -550.00</span></span>
<span><span class="co">#&gt; 5    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -500.00</span></span>
<span><span class="co">#&gt; 6    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -450.00</span></span>
<span><span class="co">#&gt;        pred       upr       lwr  CI</span></span>
<span><span class="co">#&gt; 1 -2.595106 -2.645416 -2.545336 95%</span></span>
<span><span class="co">#&gt; 2 -2.525323 -2.573514 -2.477192 95%</span></span>
<span><span class="co">#&gt; 3 -2.484152 -2.531095 -2.437165 95%</span></span>
<span><span class="co">#&gt; 4 -2.442982 -2.488677 -2.397202 95%</span></span>
<span><span class="co">#&gt; 5 -2.401812 -2.446303 -2.357156 95%</span></span>
<span><span class="co">#&gt; 6 -2.360642 -2.403982 -2.317151 95%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="errors-in-variable-change-point-model-eiv_cp_t">Errors-in-Variable Change Point Model
(<strong>“eiv_cp_t”</strong>)<a class="anchor" aria-label="anchor" href="#errors-in-variable-change-point-model-eiv_cp_t"></a>
</h2>
<p>The Errors-in-Variable Change Point model is an extension of the
linear regression and allows the user to specify the number of change
points required.</p>
<p>This technique focuses on 1 site and the maximum number of change
points available to the user is 3. We do not recommended for multiple
proxy sites together. Tide gauge data can be included to gain insight
into recent changes in RSL, however, the user must investigate which
tide gauge is most suitable. It is important to note that certain data
sites will not work with 2 or 3 change points as there is no distinct
changing points in the data. In this case, we recommend testing
different number of change points and reviewing the resulting plots to
confirm the correct number of change points is selected.</p>
<p>As an example, we will filter the example dataset
<code>NAACproxydata</code> to select one site to demonstrate the
process:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 1 site</span></span>
<span><span class="va">CedarIslandNC</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="va"><a href="../reference/NAACproxydata.html">NAACproxydata</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"Cedar Island"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 1:</strong> Load in the data using the
<code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CedarIslandNC_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">CedarIslandNC</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this function, the user can select to add tide gauge data and
estimates for linear_rate, by changing
<code>include_tide_gauge = TRUE</code> and
<code>include_linear_rate = TRUE</code> respectfully. If
<code>include_tide_gauge = TRUE</code> the user must decide if they
require the closest tide gauge
i.e. <code>TG_minimum_dist_proxy = TRUE</code>, or select specific tide
gauge i.e. <code>list_preferred_TGs = c("ARGENTIA")</code>, or all tide
gauges within 1 degree of the proxy site
i.e. <code>all_TG_1deg = TRUE</code>. The default setting is
<code>sediment_average_TG = 10</code> which corresponds to sediment
accumulation rates of the proxy records, yet the user has the ability to
alter this sediment accumulation rate by changing the size of the
rolling window average.</p>
<p>Note that for a change point model, we recommend using the default
settings as demonstrated in the above code chunk. The user can alter the
resolution of the output plots using <code>prediction_grid_res</code>
with the default set at 50 years. The output of this function is a list
of two dataframes called <code>data</code> and <code>data_grid</code>. -
The <code>data</code> dataframe is the inputted data with additional
column for the data_type_id which will contain, “ProxyRecord”. It can be
accessed by:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Region         Site Latitude Longitude   RSL  Age Age_err RSL_err</span></span>
<span><span class="co">#&gt; 1 North Carolina Cedar Island   34.971    -76.38 -0.12 2005    2.25    0.06</span></span>
<span><span class="co">#&gt; 2 North Carolina Cedar Island   34.971    -76.38 -0.14 1996    2.00    0.06</span></span>
<span><span class="co">#&gt; 3 North Carolina Cedar Island   34.971    -76.38 -0.16 1988    5.00    0.06</span></span>
<span><span class="co">#&gt; 4 North Carolina Cedar Island   34.971    -76.38 -0.18 1979    5.75    0.06</span></span>
<span><span class="co">#&gt; 5 North Carolina Cedar Island   34.971    -76.38 -0.19 1974    5.50    0.06</span></span>
<span><span class="co">#&gt; 6 North Carolina Cedar Island   34.971    -76.38 -0.21 1963    5.50    0.06</span></span>
<span><span class="co">#&gt;                         SiteName data_type_id</span></span>
<span><span class="co">#&gt; 1 Cedar Island,\n North Carolina  ProxyRecord</span></span>
<span><span class="co">#&gt; 2 Cedar Island,\n North Carolina  ProxyRecord</span></span>
<span><span class="co">#&gt; 3 Cedar Island,\n North Carolina  ProxyRecord</span></span>
<span><span class="co">#&gt; 4 Cedar Island,\n North Carolina  ProxyRecord</span></span>
<span><span class="co">#&gt; 5 Cedar Island,\n North Carolina  ProxyRecord</span></span>
<span><span class="co">#&gt; 6 Cedar Island,\n North Carolina  ProxyRecord</span></span></code></pre></div>
<ul>
<li>The <code>data_grid</code> is a dataframe that is evenly spaced in
time based on the <code>prediction_grid_res</code> value chosen by the
user and is used to create the plots and is accessed by</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grid</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data_grid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   SiteName [1]</span></span></span>
<span><span class="co">#&gt;   Longitude Latitude SiteName                         data_type_id   Age</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">735.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">650</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">600</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">550</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">500</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">450</span></span></span></code></pre></div>
<p><strong>Step 1a:</strong> A brief insight into the outputs of the
<code>reslr_input</code> function can be obtained using:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr input object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Decadally averaged tide gauge data was not included. It is recommended for the ni_gam_decomp model </span></span>
<span><span class="co">#&gt; The linear_rate or linear_rate_err was not included. It is required for the ni_gam_decomp model</span></span></code></pre></div>
<p><strong>Step 2:</strong> Plotting the data the raw data with:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotdatacp-1.png" width="672" style="display: block; margin: auto;">
This will produce a plot of Age on the x-axis and Relative Sea Level on
the y-axis in meters. Grey boxes represent the uncertainty associated
with the vertical and horizontal uncertainty. The black data points are
the midpoints of these uncertainty boxes. The extra arguments can be
used which allows the user to updated the titles and axis labels. The
caption <code>plot_caption</code>, included by default, provides the
number of proxy sites and tide gauge sites that will be used in the
model and can be removed if required <code>plot_caption = FALSE</code>.
The user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code>.</p>
<p><strong>Step 3:</strong> Run the model using the following code and
select the number of change points you require:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_cp1_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_cp_t"</span>,</span>
<span>  n_cp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Compiling model graph</span></span>
<span><span class="co">#&gt;    Resolving undeclared variables</span></span>
<span><span class="co">#&gt;    Allocating nodes</span></span>
<span><span class="co">#&gt; Graph information:</span></span>
<span><span class="co">#&gt;    Observed stochastic nodes: 208</span></span>
<span><span class="co">#&gt;    Unobserved stochastic nodes: 109</span></span>
<span><span class="co">#&gt;    Total graph size: 1637</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initializing model</span></span></code></pre></div>
<p>If the user is interested in running 2 change points use method:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_cp2_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_cp_t"</span>,</span>
<span>  n_cp <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Updating the default setting to include an additional change point.</span></span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>CI</code> setting allows the user to set the credible
intervals, the current default is <code>CI = 0.95</code>. Similar to the
earlier model, the output object <code>res_eiv_cp1_t</code> stores the
JAGS model run and should take a second to run.</p>
<p><strong>Step 3a:</strong> A brief insight into the outputs of the
<code>reslr_output</code> function can be obtained using:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_eiv_cp1_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr output object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; The model used was the Errors-in-Variables Change Point model with 1 change point.</span></span>
<span><span class="co">#&gt; The input data has been run via reslr_mcmc and has produced 3000 iterations over 3 MCMC chains.</span></span></code></pre></div>
<p><strong>Step 4:</strong> The convergence of the algorithm is examined
and the parameter estimates from the model can be investigated using the
following:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_eiv_cp1_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; No convergence issues detected.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 7</span></span></span>
<span><span class="co">#&gt;   variable                 mean     sd    mad        q5     q95  rhat</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> alpha                 -<span style="color: #BB0000;">1.03</span>   0.591  0.086<span style="text-decoration: underline;">5</span> -<span style="color: #BB0000;">2.06</span>     -<span style="color: #BB0000;">0.564</span>   1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> beta[1]                0.659  0.138  0.027<span style="text-decoration: underline;">4</span>  0.367     0.765   1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> beta[2]                1.89   0.780  0.895   0.886     2.96    1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Change Point in CE: <span style="text-decoration: underline;">1</span>287      0.721  0.081<span style="text-decoration: underline;">9</span>  0.028<span style="text-decoration: underline;">6</span>    1.84    1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> sigma_y                0.015<span style="text-decoration: underline;">4</span> 0.013<span style="text-decoration: underline;">6</span> 0.010<span style="text-decoration: underline;">9</span>  0.000<span style="text-decoration: underline;">895</span>  0.042<span style="text-decoration: underline;">4</span>  1.00</span></span></code></pre></div>
<p>If the model run has the package will print: “No convergence issues
detected”. If the package prints: “Convergence issues detected, a longer
run is necessary”. The user is required to update the
<code>reslr_mcmc</code> function with additional iterations in the
following manner:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_cp1_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_cp_t"</span>,</span>
<span>  <span class="co"># Update these values</span></span>
<span>  n_iterations <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># Number of iterations</span></span>
<span>  n_burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of iterations to discard at the beginning</span></span>
<span>  n_thin <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Reduces number of output samples to save memory and computation time</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of Markov chains</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the eiv_cp_t model, the parameters of interest are the intercept
(alpha), the slopes before the change point (“beta[1]”) and after the
change point (“beta[2]”), the year of the change point (Change Point)
and “sigma_y” the variance of the model.</p>
<p><strong>Step 5:</strong> The results from the EIV Change Point model
can be illustrated using:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_eiv_cp1_t</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotcpres-1.png" width="672" style="display: block; margin: auto;">
The output of this function is a graph of the input data, i.e. Age and
RSL and associated uncertainty boxes, and the model fit with 95 %
credible interval. The caption provides the model type used and number
of proxy sites and tide gauge sites used and can be removed if necessary
with <code>plot_caption = FALSE</code>.</p>
<p>To examine the data creating these plots the user types the
following:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_dataframes</span> <span class="op">&lt;-</span> <span class="va">res_eiv_cp1_t</span><span class="op">$</span><span class="va">output_dataframes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output_dataframes</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Longitude Latitude                       SiteName data_type_id     Age</span></span>
<span><span class="co">#&gt; 1    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -734.75</span></span>
<span><span class="co">#&gt; 2    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -650.00</span></span>
<span><span class="co">#&gt; 3    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -600.00</span></span>
<span><span class="co">#&gt; 4    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -550.00</span></span>
<span><span class="co">#&gt; 5    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -500.00</span></span>
<span><span class="co">#&gt; 6    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -450.00</span></span>
<span><span class="co">#&gt;        pred       upr       lwr  CI</span></span>
<span><span class="co">#&gt; 1 -2.458808 -2.542270 -2.300947 95%</span></span>
<span><span class="co">#&gt; 2 -2.402927 -2.477268 -2.272236 95%</span></span>
<span><span class="co">#&gt; 3 -2.369960 -2.438845 -2.255046 95%</span></span>
<span><span class="co">#&gt; 4 -2.336992 -2.400395 -2.235837 95%</span></span>
<span><span class="co">#&gt; 5 -2.304024 -2.361986 -2.216076 95%</span></span>
<span><span class="co">#&gt; 6 -2.271056 -2.323434 -2.194853 95%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="errors-in-variable-integrated-gaussian-process-model-eiv_igp_t">Errors-in-Variable Integrated Gaussian Process Model
(<strong>“eiv_igp_t”</strong>)<a class="anchor" aria-label="anchor" href="#errors-in-variable-integrated-gaussian-process-model-eiv_igp_t"></a>
</h2>
<p>The EIV Integrated Gaussian Process model provides the underlying
rate of the process directly from the model. Further reading on this
modeling approach can be found <a href="https://projecteuclid.org/journals/annals-of-applied-statistics/volume-9/issue-2/Modeling-sea-level-change-using-errors-in-variables-integrated-Gaussian/10.1214/15-AOAS824.full" class="external-link">here</a>.</p>
<p>This technique focuses on 1 site and we do not recommended for
multiple proxy sites together. Tide gauge data can be included to gain
insight into recent changes in RSL, however, the user must investigate
which tide gauge is suitable. As an example, we will filter the example
dataset <code>NAACproxydata</code> to select one site to demonstrate the
process:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 1 site</span></span>
<span><span class="va">CedarIslandNC</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="va"><a href="../reference/NAACproxydata.html">NAACproxydata</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"Cedar Island"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 1:</strong> Load in the data using the
<code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CedarIslandNC_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">CedarIslandNC</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this function, the user can select to add tide gauge data and
estimates for linear_rate, by changing
<code>include_tide_gauge = TRUE</code> and
<code>include_linear_rate = TRUE</code> respectfully. If
<code>include_tide_gauge = TRUE</code> the user must decide if they
require the closest tide gauge
i.e. <code>TG_minimum_dist_proxy = TRUE</code>, or select specific tide
gauge i.e. <code>list_preferred_TGs = c("ARGENTIA")</code>, or all tide
gauges within 1 degree of the proxy site
i.e. <code>all_TG_1deg = TRUE</code>. The default setting is
<code>sediment_average_TG = 10</code> which corresponds to sediment
accumulation rates of the proxy records, yet the user has the ability to
alter this sediment accumulation rate.</p>
<p>Note that for an IGP we recommend using the default settings as
demonstrated in the above code chunk. The user can alter the resolution
of the output plots using <code>prediction_grid_res</code> with the
default set at 50 years. The output of this function is a list of two
dataframes called <code>data</code> and <code>data_grid</code>. - The
<code>data</code> dataframe is the inputted data with additional columns
for the data_type_id which will contain “ProxyRecord”. It can be
accessed by:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<ul>
<li>The <code>data_grid</code> is a dataframe that is evenly spaced in
time based on the <code>prediction_grid_res</code> value chosen by the
user and is used to create the plots and is accessed by</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grid</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data_grid</span></span></code></pre></div>
<p><strong>Step 1a:</strong> A brief insight into the outputs of the
<code>reslr_input</code> function can be obtained using:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr input object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Decadally averaged tide gauge data was not included. It is recommended for the ni_gam_decomp model </span></span>
<span><span class="co">#&gt; The linear_rate or linear_rate_err was not included. It is required for the ni_gam_decomp model</span></span></code></pre></div>
<p><strong>Step 2:</strong> Plotting the data the raw data with:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotigpdata-1.png" width="672" style="display: block; margin: auto;">
This will produce a plot of Age on the x-axis and Relative Sea Level on
the y-axis in meters. Grey boxes represent the uncertainty associated
with the vertical and horizontal uncertainty. The black data points are
the midpoints of these uncertainty boxes. The extra arguments can be
used which allows the user to updated the titles and axis labels. The
caption <code>plot_caption</code>, included by default, provides the
number of proxy sites and tide gauge sites that will be used in the
model and can be removed if required <code>plot_caption = FALSE</code>.
In addition, the user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code>.</p>
<p><strong>Step 3:</strong> To run the eiv_igp_t model the following
function should be used:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_igp_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_igp_t"</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  </span>
<span><span class="op">)</span></span></code></pre></div>
<p>This command takes the input data and the user specifies the
statistical model, i.e. an integrated Gaussian process using the EIV
uncertainty method (“eiv_slr_t”). It tells <code>reslr</code> to store
the output of the model run in an object called
<code>res_eiv_igp_t</code>. The <code>CI</code> setting allows the user
to set the credible intervals, the current default is
<code>CI = 0.95</code>. The computational run time for this model is
approximately 14 minutes.</p>
<p><strong>Step 3a:</strong> A brief insight into the outputs of the
<code>reslr_output</code> function can be obtained using:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_eiv_igp_t</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 4:</strong> The convergence of the algorithm is examined
and he parameter estimates from the model can be investigated using the
following:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_eiv_igp_t</span><span class="op">)</span></span></code></pre></div>
<p>If the model run has the package will print: “No convergence issues
detected”. If the package prints: “Convergence issues detected, a longer
run is necessary”. The user is required to update the
<code>reslr_mcmc</code> function with additional iterations in the
following manner:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_igp_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_igp_t"</span>,</span>
<span>  <span class="co"># Update these values</span></span>
<span>  n_iterations <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># Number of iterations</span></span>
<span>  n_burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of iterations to discard at the beginning</span></span>
<span>  n_thin <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Reduces number of output samples to save memory and computation time</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of Markov chains</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the parameter estimates, the length scale parameter, “rho” is the
correlation parameter and “nu” is the standard deviation of the rate
process. “sigma_y” is the variation of the model.</p>
<p><strong>Step 5:</strong> The results from the EIV IGP model can be
illustrated using:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_eiv_igp_t</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"model_fit_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotigpres-1.png" width="100%" style="display: block; margin: auto;">
The output of this function is a graph of the input data, i.e. Age and
RSL and associated uncertainty boxes, and the model fit with 95 %
credible interval. The caption provides the model type used and number
of proxy sites and tide gauge sites used and can be removed if necessary
with <code>plot_caption = FALSE</code>. In order to view the rate of
change plot, the following setting should be used:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_eiv_igp_t</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"rate_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  y_rate_lab <span class="op">=</span> <span class="st">"Rate of Change (mm per year)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotigpresrate-1.png" width="100%" style="display: block; margin: auto;">
This prints the plot of the rate of change with 95 % credible intervals.
The caption provides the model type, the number of proxy sites and tide
gauge sites that were used.</p>
<p>To examine the data creating these plots the user types the
following:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_dataframes</span> <span class="op">&lt;-</span> <span class="va">res_eiv_igp_t</span><span class="op">$</span><span class="va">output_dataframes</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="noisy-input-spline-in-time-ni_spline_t">Noisy input spline in time (<strong>“ni_spline_t”</strong>)<a class="anchor" aria-label="anchor" href="#noisy-input-spline-in-time-ni_spline_t"></a>
</h2>
<p>An alternative method to examine how the response variable varies in
time is using the Noisy input spline in time (ni_spline_t). It model can
obtain results in more efficient computational run times when compared
with the eiv_igp_t model.</p>
<p>This technique focuses on 1 site and we do not recommended for
multiple proxy sites together. Tide gauge data can be used to gain
insight into recent RSL changes. As an example, we will filter the
example dataset <code>NAACproxydata</code> to select one site to
demonstrate the process:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 1 site</span></span>
<span><span class="va">CedarIslandNC</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="va"><a href="../reference/NAACproxydata.html">NAACproxydata</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"Cedar Island"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 1:</strong> Load in the data using the
<code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CedarIslandNC_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">CedarIslandNC</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this function, the user can select to add tide gauge data and
estimates for linear_rate, by changing
<code>include_tide_gauge = TRUE</code> and
<code>include_linear_rate = TRUE</code> respectfully. If
<code>include_tide_gauge = TRUE</code> the user must decide if they
require the closest tide gauge
i.e. <code>TG_minimum_dist_proxy = TRUE</code>, or select specific tide
gauge i.e. <code>list_preferred_TGs = c("ARGENTIA")</code>, or all tide
gauges within 1 degree of the proxy site
i.e. <code>all_TG_1deg = TRUE</code>. The default setting is
<code>sediment_average_TG = 10</code> which corresponds to sediment
accumulation rates of the proxy records, yet the user has the ability to
alter this sediment accumulation rate by changing the size of the
rolling window average.</p>
<p>Note that for a spline in time, we recommend using the default
settings as demonstrated in the above code chunk. The user can alter the
resolution of the output plots using <code>prediction_grid_res</code>
with the default set at 50 years. The output of this function is a list
of two dataframes called <code>data</code> and <code>data_grid</code>. -
The <code>data</code> dataframe is the inputted data with additional
columns for the data_type_id which will contain “ProxyRecord”. It can be
accessed by:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<ul>
<li>The <code>data_grid</code> is a dataframe that is evenly spaced in
time based on the <code>prediction_grid_res</code> value chosen by the
user and is used to create the plots and is accessed by</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grid</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input</span><span class="op">$</span><span class="va">data_grid</span></span></code></pre></div>
<p><strong>Step 1a:</strong> A brief insight into the outputs of the
<code>reslr_input</code> function can be obtained using:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr input object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Decadally averaged tide gauge data was not included. It is recommended for the ni_gam_decomp model </span></span>
<span><span class="co">#&gt; The linear_rate or linear_rate_err was not included. It is required for the ni_gam_decomp model</span></span></code></pre></div>
<p><strong>Step 2:</strong> Plotting the data the raw data with:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotspt-1.png" width="672" style="display: block; margin: auto;">
This will produce a plot of Age on the x-axis and Relative Sea Level on
the y-axis in meters. Grey boxes represent the uncertainty associated
with the vertical and horizontal uncertainty. The black data points are
the midpoints of these uncertainty boxes. The following extra arguments
can be used which allows the user to updated the titles and axis labels.
The caption <code>plot_caption</code>, included by default, provides the
number of proxy sites and tide gauge sites that will be used in the
model and can be removed if required <code>plot_caption = FALSE</code>.
In addition, the user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code>.</p>
<p><strong>Step 3:</strong> To run this model type use the
following:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_spline_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"ni_spline_t"</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output object <code>res_ni_spline_t</code> stores the JAGS model
run. The <code>CI</code> setting allows the user to set the credible
intervals, the current default is <code>CI = 0.95</code>. Note that
there will be two model runs printed in the console here but the output
will be the same format as earlier models.</p>
<p><strong>Step 3a:</strong> A brief insight into the outputs of the
<code>reslr_output</code> function can be obtained using:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_ni_spline_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr output object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; The model used was the Noisy Input Spline in time model.</span></span>
<span><span class="co">#&gt; The input data has been run via reslr_mcmc and has produced 3000 iterations over 3 MCMC chains.</span></span></code></pre></div>
<p><strong>Step 4:</strong> The convergence of the algorithm is examined
and he parameter estimates from the model can be investigated using the
following:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_ni_spline_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; No convergence issues detected.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   variable      mean      sd     mad       q5    q95  rhat</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;num&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> sigma_beta 2.09    0.696   0.528   1.27     3.33    1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sigma_y    0.006<span style="text-decoration: underline;">10</span> 0.004<span style="text-decoration: underline;">80</span> 0.004<span style="text-decoration: underline;">46</span> 0.000<span style="text-decoration: underline;">393</span> 0.015<span style="text-decoration: underline;">4</span>  1.00</span></span></code></pre></div>
<p>If the model run has the package will print: “No convergence issues
detected”. If the package prints: “Convergence issues detected, a longer
run is necessary”. The user is required to update the
<code>reslr_mcmc</code> function with additional iterations in the
following manner:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_spline_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"ni_spline_t"</span>,</span>
<span>  <span class="co"># Update these values</span></span>
<span>  n_iterations <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># Number of iterations</span></span>
<span>  n_burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of iterations to discard at the beginning</span></span>
<span>  n_thin <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Reduces number of output samples to save memory and computation time</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of Markov chains</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the parameter estimates, we can present the standard deviation
associated with the NI spline time model. Where “sigma_beta” highlights
the variation associated with the spline coefficient for the spline in
time and “sigma_y” presenting the overall variation of the model.</p>
<p><strong>Step 5:</strong> the results from the ni_spline_t model can
be illustrated using:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_spline_t</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"model_fit_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotsptres-1.png" width="672" style="display: block; margin: auto;">
The output of this function is a graph of the input data, i.e. Age and
RSL and associated uncertainty boxes, and the model fit with 95 %
credible interval. The caption provides the model type used and number
of proxy sites and tide gauge sites used and can be removed if necessary
with <code>plot_caption = FALSE</code>. In order to view the rate of
change plot, the following setting should be used:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_spline_t</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"rate_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  y_rate_lab <span class="op">=</span> <span class="st">"Rate of Change (mm per year)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotsptresrate-1.png" width="672" style="display: block; margin: auto;">
This prints the plot of the rate of change with 95 % credible intervals.
Again, the caption provides the model type, number of proxy sites and
tide gauge sites that were used.</p>
<p>To examine the data creating these plots the user types the
following:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_dataframes</span> <span class="op">&lt;-</span> <span class="va">res_ni_spline_t</span><span class="op">$</span><span class="va">output_dataframes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output_dataframes</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Longitude Latitude                       SiteName data_type_id     Age</span></span>
<span><span class="co">#&gt; 1    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -734.75</span></span>
<span><span class="co">#&gt; 2    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -650.00</span></span>
<span><span class="co">#&gt; 3    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -600.00</span></span>
<span><span class="co">#&gt; 4    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -550.00</span></span>
<span><span class="co">#&gt; 5    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -500.00</span></span>
<span><span class="co">#&gt; 6    -76.38   34.971 Cedar Island,\n North Carolina  ProxyRecord -450.00</span></span>
<span><span class="co">#&gt;        pred       upr       lwr   rate_pred    rate_upr  rate_lwr  CI</span></span>
<span><span class="co">#&gt; 1 -2.318161 -2.381749 -2.250520 -0.02742948 -0.43017297 0.3886927 95%</span></span>
<span><span class="co">#&gt; 2 -2.314766 -2.366141 -2.261277  0.10560349 -0.18593984 0.4002811 95%</span></span>
<span><span class="co">#&gt; 3 -2.307644 -2.358049 -2.257750  0.17860457 -0.05675855 0.4164699 95%</span></span>
<span><span class="co">#&gt; 4 -2.296973 -2.345985 -2.246936  0.24753558  0.05639483 0.4318950 95%</span></span>
<span><span class="co">#&gt; 5 -2.282958 -2.331777 -2.231703  0.31239650  0.16012718 0.4540374 95%</span></span>
<span><span class="co">#&gt; 6 -2.265802 -2.314405 -2.215494  0.37318733  0.25349791 0.4834276 95%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="noisy-input-spline-in-space-time-ni_spline_st">Noisy input spline in space time
(<strong>“ni_spline_st”</strong>)<a class="anchor" aria-label="anchor" href="#noisy-input-spline-in-space-time-ni_spline_st"></a>
</h2>
<p>The Noisy input spline in space time examines changes in RSL over
multiple locations and throughout time. For this model, a minimum of 2
proxy sites should be used and tide gauge data provides insight into
recent changes in RSL if the user is requires_ As an example, we will
filter the example dataset <code>NAACproxydata</code> to select two
sites to demonstrate the process:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 2 site</span></span>
<span><span class="va">multi_site</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="va"><a href="../reference/NAACproxydata.html">NAACproxydata</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cedar Island"</span>, <span class="st">"Nassau"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 1:</strong> Load in the data using the
<code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multi_site_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">multi_site</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this function, the user can select to add tide gauge data and
estimates for linear_rate, by changing
<code>include_tide_gauge = TRUE</code> and
<code>include_linear_rate = TRUE</code> respectfully. If
<code>include_tide_gauge = TRUE</code> the user must decide if they
require the closest tide gauge
i.e. <code>TG_minimum_dist_proxy = TRUE</code>, or select specific tide
gauge i.e. <code>list_preferred_TGs = c("ARGENTIA")</code>, or all tide
gauges within 1 degree of the proxy site
i.e. <code>all_TG_1deg = TRUE</code>. The default setting is
<code>rolling_window_average = 10</code> which corresponds to sediment
accumulation rates of the proxy records, yet the user has the ability to
alter this sediment accumulation rate.</p>
<p>Note that for a spline in space time, we recommend using the default
settings as demonstrated in the above code chunk or investigating the
resulting plots if additional tide gauge data could provide insight into
recent changes. The user can alter the resolution of the output plots
using <code>prediction_grid_res</code> with the default set at 50 years.
The output of this function is a list of two dataframes called
<code>data</code> and <code>data_grid</code>. - The <code>data</code>
dataframe is the inputted data with additional columns for the
linear_rate, linear_rate_err and data_type_id which will contain two
options, “ProxyRecord” or “TideGaugeData”. It can be accessed by:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">multi_site_input</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Region   Site Latitude Longitude   RSL  Age Age_err RSL_err</span></span>
<span><span class="co">#&gt; 1 Florida Nassau   30.587   -81.666  0.05 2002    4.25    0.07</span></span>
<span><span class="co">#&gt; 2 Florida Nassau   30.587   -81.666  0.03 1990    5.50    0.07</span></span>
<span><span class="co">#&gt; 3 Florida Nassau   30.587   -81.666  0.01 1980    4.25    0.07</span></span>
<span><span class="co">#&gt; 4 Florida Nassau   30.587   -81.666 -0.01 1974    4.50    0.07</span></span>
<span><span class="co">#&gt; 5 Florida Nassau   30.587   -81.666 -0.03 1964    9.50    0.07</span></span>
<span><span class="co">#&gt; 6 Florida Nassau   30.587   -81.666 -0.05 1936   10.75    0.07</span></span>
<span><span class="co">#&gt;            SiteName data_type_id</span></span>
<span><span class="co">#&gt; 1 Nassau,\n Florida  ProxyRecord</span></span>
<span><span class="co">#&gt; 2 Nassau,\n Florida  ProxyRecord</span></span>
<span><span class="co">#&gt; 3 Nassau,\n Florida  ProxyRecord</span></span>
<span><span class="co">#&gt; 4 Nassau,\n Florida  ProxyRecord</span></span>
<span><span class="co">#&gt; 5 Nassau,\n Florida  ProxyRecord</span></span>
<span><span class="co">#&gt; 6 Nassau,\n Florida  ProxyRecord</span></span></code></pre></div>
<ul>
<li>The <code>data_grid</code> is a dataframe that is evenly spaced in
time based on the <code>prediction_grid_res</code> value chosen by the
user and is used to create the plots and is accessed by</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grid</span> <span class="op">&lt;-</span> <span class="va">multi_site_input</span><span class="op">$</span><span class="va">data_grid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   SiteName [1]</span></span></span>
<span><span class="co">#&gt;   Longitude Latitude SiteName                         data_type_id   Age</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">735.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">650</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">600</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">550</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">500</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     -<span style="color: #BB0000;">76.4</span>     35.0 <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> ProxyRecord  -<span style="color: #BB0000;">450</span></span></span></code></pre></div>
<p><strong>Step 1a:</strong> A brief insight into the outputs of the
<code>reslr_input</code> function can be obtained using:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">multi_site_input</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr input object with 169 observations and  2 site(s).</span></span>
<span><span class="co">#&gt; There are  2  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Decadally averaged tide gauge data was not included. It is recommended for the ni_gam_decomp model </span></span>
<span><span class="co">#&gt; The linear_rate or linear_rate_err was not included. It is required for the ni_gam_decomp model</span></span></code></pre></div>
<p><strong>Step 2:</strong> Plotting the data the raw data with:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">multi_site_input</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotspst-1.png" width="672" style="display: block; margin: auto;">
This will produce a plot of Age on the x-axis and Relative Sea Level on
the y-axis in meters. Grey boxes represent the uncertainty associated
with the vertical and horizontal uncertainty. The black data points are
the midpoints of these uncertainty boxes. The separate sites will appear
in separate windows on the plot. The extra arguments can be used which
allows the user to updated the titles and axis labels. The caption
<code>plot_caption</code>, included by default, provides the number of
proxy sites and tide gauge sites that will be used in the model and can
be removed if required <code>plot_caption = FALSE</code>. In addition,
the user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code>.</p>
<p><strong>Step 3:</strong> Run the model for the two sites.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_spline_st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">multi_site_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"ni_spline_st"</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output object <code>jags_output.ni_spline_st</code> stores the
JAGS model run. The <code>CI</code> setting allows the user to set the
credible intervals, the current default is <code>CI = 0.95</code>. Note
that additional computational run time is required for this model
compared with the ni_spline_t.</p>
<p><strong>Step 3a:</strong> A brief insight into the outputs of the
<code>reslr_output</code> function can be obtained using:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_ni_spline_st</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 4:</strong> The convergence of the algorithm is examined
and he parameter estimates from the model can be investigated using the
following:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_ni_spline_st</span><span class="op">)</span></span></code></pre></div>
<p>If the model run has the package will print: “No convergence issues
detected”. If the package prints: “Convergence issues detected, a longer
run is necessary”. The user is required to update the
<code>reslr_mcmc</code> function with additional iterations in the
following manner:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_spline_st</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">multi_site_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"ni_spline_st"</span>,</span>
<span>  <span class="co"># Update these values</span></span>
<span>  n_iterations <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># Number of iterations</span></span>
<span>  n_burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of iterations to discard at the beginning</span></span>
<span>  n_thin <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Reduces number of output samples to save memory and computation time</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of Markov chains</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the parameter estimates, we can present the standard deviation
associated with the NI spline space time model. Where “sigma_beta”
highlights the variation associated with the spline coefficient of the
spline in time and “sigma_y” presenting the overall variation.</p>
<p><strong>Step 5:</strong> the results from the ni_spline_st model can
be illustrated using:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_spline_st</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"model_fit_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotspstres-1.png" width="100%" style="display: block; margin: auto;">
The output of this function is a graph of the input data, i.e. Age and
RSL and associated uncertainty boxes, and the model fit with 95 %
credible interval. The caption provides the model type used and number
of proxy sites and tide gauge sites used and can be removed if necessary
with <code>plot_caption = FALSE</code>. In order to view the rate of
change plot, the following setting should be used:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_spline_st</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"rate_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  y_rate_lab <span class="op">=</span> <span class="st">"Rate of Change (mm per year)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotspstresrate-1.png" width="100%" style="display: block; margin: auto;">
This will print the plot of the rate of change with 95 % credible
intervals. Again, the caption provides the model type, the number of
proxy sites and tide gauge sites that were used.</p>
<p>To examine the data creating these plots the user types the
following:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_dataframes</span> <span class="op">&lt;-</span> <span class="va">res_ni_spline_st</span><span class="op">$</span><span class="va">output_dataframes</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="noisy-input-generalised-additive-model-for-decomposition-of-response-signal-ni_gam_decomp">Noisy Input Generalised Additive Model for decomposition of response
signal (<strong>“ni_gam_decomp”</strong>)<a class="anchor" aria-label="anchor" href="#noisy-input-generalised-additive-model-for-decomposition-of-response-signal-ni_gam_decomp"></a>
</h2>
<p>The Noisy Input Generalised Additive Model for the decomposition of
the response signal (RSL). In the case of RSL, there are different
drivers influence the changing RSL signal and these drivers vary in time
and space. .The three main components of RSL change being examined using
this model type at a regional, local linear component and non-linear
local component. A detailed description of this model can be found <a href="https://arxiv.org/abs/2301.09556" class="external-link">here</a>.</p>
<p>There are a number of settings within the package that are important
when using this model type. For the local linear component, GIA rate and
associated uncertainty of the GIA rate must be provided prior to
running. If the GIA rate is not provided for each location, then the
<code>reslr</code> package will calculate it using the data and if this
is not possible, the package will print an error message. Also, we
recommend using tide gauge data averaged over a decade to match the
accumulation rates of the proxy records, which is an additional argument
in the function.</p>
<p>This model needs an adequate number of proxy sites to perform the
decomposition and the minimum sites required will depend on the signal
of the data. We found that in general we need a minimum of five proxy
sites and at least five associated tide gauge sites. Also, we strongly
recommend using tide gauge data for this model to obtain insight into
recent changes in RSL.</p>
<p>As an example, we will filter the example dataset
<code>NAACproxydata</code> to select nine random sites to demonstrate
the process:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 9 site</span></span>
<span><span class="va">multi_9_sites</span> <span class="op">&lt;-</span> <span class="fu">reslr</span><span class="fu">::</span><span class="va"><a href="../reference/NAACproxydata.html">NAACproxydata</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Cedar Island"</span>, <span class="st">"Nassau"</span>, <span class="st">"Snipe Key"</span>,</span>
<span>    <span class="st">"Placentia"</span>, <span class="st">"Cape May Courthouse"</span>, <span class="st">"East River Marsh"</span>,</span>
<span>    <span class="st">"Fox Hill Marsh"</span>, <span class="st">"Swan Key"</span>, <span class="st">"Big River Marsh"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 1:</strong> Load in the data using the
<code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multi_9_sites_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">multi_9_sites</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The legacy packages maptools, rgdal, and rgeos, underpinning this package</span></span>
<span><span class="co">#&gt; will retire shortly. Please refer to R-spatial evolution reports on</span></span>
<span><span class="co">#&gt; https://r-spatial.org/r/2023/05/15/evolution4.html for details.</span></span>
<span><span class="co">#&gt; This package is now running under evolution status 0</span></span></code></pre></div>
<p>In this function, the user can select to add tide gauge data and
estimates for linear_rate, by changing
<code>include_tide_gauge = TRUE</code> and
<code>include_linear_rate = TRUE</code> respectfully. If
<code>include_tide_gauge = TRUE</code> the user must decide if they
require the closest tide gauge
i.e. <code>TG_minimum_dist_proxy = TRUE</code>, or select specific tide
gauge i.e. <code>list_preferred_TGs = c("ARGENTIA")</code>, or all tide
gauges within 1 degree of the proxy site
i.e. <code>all_TG_1deg = TRUE</code>. In this example, we use all tide
gauges within 1 degree of the proxy site. The default setting is
<code>sediment_average_TG = 10</code> which corresponds to sediment
accumulation rates of the proxy records, yet the user has the ability to
alter this sediment accumulation rate.</p>
<p>Note that for this model, we recommend using the default settings as
demonstrated in the above code chunk. If the user has not provided the
linear rate and the associated linear rate uncertainty within the
<code>linear_rate</code> and <code>linear_rate_err</code> column prior
to running the package, the package to calculate it using the data.</p>
<p>The output of this function is a list of two dataframes called
<code>data</code> and <code>data_grid</code>. - The <code>data</code>
dataframe is the inputted data with additional columns for the
linear_rate, linear_rate_err and data_type_id which will contain two
options, “ProxyRecord” or “TideGaugeData”. It can be accessed by:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">multi_9_sites_input</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<ul>
<li>The <code>data_grid</code> is a dataframe that is evenly spaced in
time based on the <code>prediction_grid_res</code> value chosen by the
user and is used to create the plots and is accessed by</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grid</span> <span class="op">&lt;-</span> <span class="va">multi_9_sites_input</span><span class="op">$</span><span class="va">data_grid</span></span></code></pre></div>
<p><strong>Step 1a:</strong> A brief insight into the outputs of the
<code>reslr_input</code> function can be obtained using:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">multi_9_sites_input</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr input object with 1124 observations and  36 site(s).</span></span>
<span><span class="co">#&gt; There are  9  proxy site(s) and  27  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Decadally averaged tide gauge data included by the package. </span></span>
<span><span class="co">#&gt; The linear_rate and linear_rate_err has been included.</span></span></code></pre></div>
<p><strong>Step 2:</strong> Plotting the data the raw data with:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">multi_9_sites_input</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reslr_files/figure-html/plotnigam-1.png" width="672" style="display: block; margin: auto;">
This will produce a plot of Age on the x-axis and Relative Sea Level on
the y-axis in meters. Grey boxes represent the uncertainty associated
with the vertical and horizontal uncertainty. The black data points are
the midpoints of these uncertainty boxes. The separate sites will appear
in separate windows on the plot. The extra arguments can be used which
allows the user to updated the titles and axis labels. The caption
<code>plot_caption</code>, included by default, provides the number of
proxy sites and tide gauge sites that will be used in the model and can
be removed if required <code>plot_caption = FALSE</code>. In addition,
the user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code>.</p>
<p><strong>Step 3:</strong> Run the model</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_gam_decomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">multi_9_sites_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"ni_gam_decomp"</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output object <code>res_ni_gam_decomp</code> stores the JAGS
model run. The <code>CI</code> setting allows the user to set the
credible intervals, the current default is <code>CI = 0.95</code>. Note
that there will be two model runs printed in the console here but the
output will be the same format as earlier models.</p>
<p><strong>Step 3a:</strong> A brief insight into the outputs of the
<code>reslr_output</code> function can be obtained using:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 4:</strong> The convergence of the algorithm is examined
and he parameter estimates from the model can be investigated using the
following:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span><span class="op">)</span></span></code></pre></div>
<p>If the model run has the package will print: “No convergence issues
detected”. If the package prints: “Convergence issues detected, a longer
run is necessary”. The user is required to update the
<code>reslr_mcmc</code> function with additional iterations in the
following manner:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_gam_decomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">multi_9_sites_input</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"ni_gam_decomp"</span>,</span>
<span>  <span class="co"># Update these values</span></span>
<span>  n_iterations <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># Number of iterations</span></span>
<span>  n_burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of iterations to discard at the beginning</span></span>
<span>  n_thin <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Reduces number of output samples to save memory and computation time</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of Markov chains</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the parameter estimates, we can present the standard deviation
associated with each component of the NIGAM decomposition. This gives an
insight into the variation caused by the different components with
“sigma_r” representing the regional component, “sigma_l” highlighting
the non-linear local component, “sigma_y” presenting the overall
variation and “sigma_h” representing the site specific vertical
offset.</p>
<p><strong>Step 5:</strong> The results from the
<code>ni_gam_decomp</code> model can be illustrated with the option of
excluding the tide gauge using:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"model_fit_plot"</span>,</span>
<span>  plot_tide_gauge <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotnigamres-1.png" width="100%" style="display: block; margin: auto;">
In addition, the user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code> in the plot. The output of this
function is a graph of the input data, i.e. Age and RSL and associated
uncertainty boxes, and the model fit with 95 % credible interval. The
caption provides the model type used and number of proxy sites and tide
gauge sites used and can be removed if necessary with
<code>plot_caption = FALSE</code>. In order to view the rate of change
plot, the following setting should be used:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"rate_plot"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/docs/reslrvigplots/plotnigamresrate-1.png" width="100%" style="display: block; margin: auto;">
This will print the plot of the rate of change with 95 % credible
intervals. The caption provides the model type, the number of proxy
sites and tide gauge sites that were used. To examine the data creating
the total model fit and the rate of change plot, the user can use:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">total_model_fit_df</span> <span class="op">&lt;-</span> <span class="va">res_ni_gam_decomp</span><span class="op">$</span><span class="va">output_dataframes</span><span class="op">$</span><span class="va">total_model_fit_df</span></span></code></pre></div>
<p>There are separate settings to examine the plot of each component and
its associated rate. To examine the regional component plot use:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>, plot_type <span class="op">=</span> <span class="st">"regional_plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotnigamregres-1.png" width="100%" style="display: block; margin: auto;">
The regional component and the rate of change of the regional component
is presented with 95% credible interval. The caption provides the model
type used and number of proxy sites and tide gauge sites used and can be
removed if necessary with <code>plot_caption = FALSE</code>. To examine
the data creating the regional component plot and rate plot, the user
can use:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_component_df</span> <span class="op">&lt;-</span> <span class="va">res_ni_gam_decomp</span><span class="op">$</span><span class="va">output_dataframes</span><span class="op">$</span><span class="va">regional_component_df</span></span></code></pre></div>
<p>The rate for the regional component can be accessed using:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>, plot_type <span class="op">=</span> <span class="st">"regional_rate_plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotnigamregresrate-1.png" width="100%" style="display: block; margin: auto;">
Similarly, the rate of change of the regional component is presented
with 95% credible interval. The caption provides the model type used and
number of proxy sites and tide gauge sites used and can be removed if
necessary with <code>plot_caption = FALSE</code>.</p>
<p>To examine the linear local component plot use:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>, plot_type <span class="op">=</span> <span class="st">"linear_local_plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotnigamlinres-1.png" width="100%" style="display: block; margin: auto;">
The linear local component is plotted with 95% credible interval. The
caption provides the model type used and number of proxy sites and tide
gauge sites used and can be removed if necessary with
<code>plot_caption = FALSE</code>. To examine the data creating the
linear local component plot, the user can use:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lin_loc_component_df</span> <span class="op">&lt;-</span> <span class="va">res_ni_gam_decomp</span><span class="op">$</span><span class="va">output_dataframes</span><span class="op">$</span><span class="va">lin_loc_component_df</span></span></code></pre></div>
<p>The associated linear local component rates for each location can be
accessed by:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lin_loc_component_rates</span> <span class="op">&lt;-</span> <span class="va">lin_loc_component_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">SiteName</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    linear_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">linear_rate</span><span class="op">)</span>,</span>
<span>    linear_rate_err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">linear_rate_err</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>To examine the non-linear local component plot use:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>, plot_type <span class="op">=</span> <span class="st">"non_linear_local_plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotnigamnonlinres-1.png" width="100%" style="display: block; margin: auto;">
The non-linear local component is plotted with with 95% credible
interval. The caption provides the model type used and number of proxy
sites and tide gauge sites used and can be removed if necessary with
<code>plot_caption = FALSE</code>. To examine the data creating the
non-linear local component plot and rate plot, the user can use:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">non_lin_loc_component_df</span> <span class="op">&lt;-</span> <span class="va">res_ni_gam_decomp</span><span class="op">$</span><span class="va">output_dataframes</span><span class="op">$</span><span class="va">non_lin_loc_component_df</span></span></code></pre></div>
<p>The plot of the rate of change for the non-linear local component
use:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>, plot_type <span class="op">=</span> <span class="st">"non_linear_local_rate_plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotnigamnonlinresrate-1.png" width="100%" style="display: block; margin: auto;">
The rate of change of the non-linear local component is plotted with
with 95% credible interval. The caption provides the model type used and
number of proxy sites and tide gauge sites used and can be removed if
necessary with <code>plot_caption = FALSE</code>.</p>
<p>In order to examine how all components vary, the user can examine the
plot using the following method:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_ni_gam_decomp</span>, plot_type <span class="op">=</span> <span class="st">"nigam_component_plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/maeveupton/reslr/main/reslrvigplots/plotnigamall-1.png" width="100%" style="display: block; margin: auto;">
Each component is plotted with an 95% credible interval and this plot
gives insight into the variability of the different components through
time and at the different locations in question. The caption provides
the model type used and number of proxy sites and tide gauge sites used
and can be removed if necessary with
<code>plot_caption = FALSE</code>.</p>
</div>
<div class="section level2">
<h2 id="appendix---suggested-reading">Appendix - suggested reading<a class="anchor" aria-label="anchor" href="#appendix---suggested-reading"></a>
</h2>
<p>For an introduction into statistical modelling for relative sea level
change:</p>
<p>Upton, Maeve, Cahill, Niamh and Parnell, Andrew C. (2023),
‘Statistical Modelling for Relative Sea-Level Data’, Reference Module in
Earth Systems and Environmental Sciences, Elsevier</p>
<p>For the maths on the original Change Point models:</p>
<p>Cahill, Niamh, Rahmstorf, Stefan and Parnell Andrew C. (2015),
‘Change points of global temperature’, Environmental Research Letters,
10(8), 084002</p>
<p>For the maths on the original EIV models:</p>
<p>Cahill, Niamh, Kemp, Andrew C , Horton, Benjamin P and Parnell,
Andrew C (2015), ‘Modeling sea-level change using Errors-in-Variables
integrated Gaussian Process 1’, The Annals of Applied Statistics 9(2),
547–571</p>
<p>For the maths on the original NIGAM: Upton, Maeve, Parnell, Andrew C,
Kemp, Andrew C , Ashe, Erica, McCarthy, Gerard and Cahill, Niamh (2023)
‘A noisy-input generalised additive model for relative sea-level change
along the Atlantic coast of North America’</p>
<p>For the background of GIA rates:</p>
<p>Whitehouse, Pippa L (2018), ‘Glacial isostatic adjustment modelling:
historical perspectives, recent advances, and future directions’, Earth
Surf. Dynam 6, 401–429.</p>
<p>Engelhart, Simon E., Benjamin P. Horton, Bruce C. Douglas, W. Richard
Peltier and Torbj&amp;oorn E. T ̈ornqvist (2009), ‘Spatial variability
of late Holocene and 20th century sea-level rise along the Atlantic
coast of the United States’, Geology 37(12), 1115–1118</p>
<p>Peltier, W.R (2004), ‘Global Glacial Isostasy and the Surface of the
Ice-Age Earth: The ICE-5G (VM2) Model and GRACE’, Annual Review of Earth
and Planetary Sciences 32, 111–149</p>
<p>For the background to tide gauge data:</p>
<p>Pugh, David, and Philip Woodworth. 2014. “Tidal Forces: Sea-Level
Science: Understanding Tides, Surges, Tsunamis and Mean Sea-Level
Changes.” In Sea-Level Science: Understanding Tides, Surges, Tsunamis
and Mean Sea-Level Changes, 36–59. Cambridge University Press.</p>
<p>Holgate, Simon J., Andrew Matthews, Philip L. Woodworth, Lesley J.
Rickards, Mark E. Tamisiea, Elizabeth Bradshaw, Peter R. Foden, Kathleen
M. Gordon, Svetlana Jevrejeva, and Jeff Pugh. 2013. “New Data Systems
and Products at the Permanent Service for Mean Sea Level.” Journal of
Coastal Research 29 (3): 493–504.</p>
<p>Aarup, T., M. Merrifield, B. Pérez Gómez, I. Vassie, and P.Woodworth.
2006. “Manual on Sea-level Measurements and Interpretation, Volume IV :
An update to 2006.” Intergovernmental Oceanographic Commission of UNESCO
4. <a href="https://unesdoc.unesco.org/ark:/48223/pf0000147773" class="external-link uri">https://unesdoc.unesco.org/ark:/48223/pf0000147773</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maeve Upton, Andrew Parnell, Niamh Cahill.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
