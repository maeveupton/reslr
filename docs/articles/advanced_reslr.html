<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>reslr: advanced • reslr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="reslr: advanced">
<meta property="og:description" content="reslr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reslr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/reslr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced_reslr.html">reslr: advanced</a>
    </li>
    <li>
      <a href="../articles/quick_start.html">reslr: quick start guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maeveupton/reslr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>reslr: advanced</h1>
                        <h4 data-toc-skip class="author">Maeve Upton,
Andrew Parnell and Niamh Cahill</h4>
            
            <h4 data-toc-skip class="date">2023-06-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/maeveupton/reslr/blob/HEAD/vignettes/advanced_reslr.Rmd" class="external-link"><code>vignettes/advanced_reslr.Rmd</code></a></small>
      <div class="hidden name"><code>advanced_reslr.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this document we present a range of advanced options that are
available in the reslr package. To examine the all other options in the
<code>reslr</code> package, see the main vignette.</p>
<p>If you have created other examples demonstrating <code>reslr</code>
capabilities yourself, please <a href="https://github.com/maeveupton/reslr/issues" class="external-link">contact me</a> so I
can include them here for other people to see.</p>
<p>Installing <code>reslr</code> and loading it with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("reslr")</span></span>
<span><span class="co">#devtools::install_github("maeveupton/reslr",force = TRUE,INSTALL_opts = '--no-lock')</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/maeveupton/reslr" class="external-link">reslr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="errors-in-variables-integrated-gaussian-process-with-detrended-data">Errors in Variables Integrated Gaussian Process with detrended
data<a class="anchor" aria-label="anchor" href="#errors-in-variables-integrated-gaussian-process-with-detrended-data"></a>
</h2>
<p>The EIV Integrated Gaussian Process model provides the underlying
rate of the process directly from the model. If the user requires a
model applied to data that has been de-trended this is available in our
package for a single site using the
<code>model_type = "eiv_igp_t"</code>. The data is de-trended using the
linear rate which can be provided by the user within the input dataframe
along with the uncertainty associated with the rate. Or the linear rate
is calculated within the package using the data and this rate is used to
de-trend the data. In addition, the user will need to provide the
estimated year of core collection.</p>
<p>This technique focuses on 1 site and we do not recommended for
multiple proxy sites together. Tide gauge data can be included, however,
the user must investigate which tide gauge is suitable and the tide
gauge data will use the same linear_rate as the proxy records. As an
example, we will filter the example dataset <code>NAACproxydata</code>
to select one site to demonstrate the process:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 1 site</span></span>
<span><span class="va">CedarIslandNC</span> <span class="op">&lt;-</span> <span class="va">NAACproxydata</span><span class="op">[</span><span class="va">NAACproxydata</span><span class="op">$</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"Cedar Island"</span>,<span class="op">]</span></span></code></pre></div>
<p><strong>Step 1:</strong> Load in the data using the
<code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CedarIslandNC_input_detrend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">CedarIslandNC</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  detrend_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  core_col_year <span class="op">=</span> <span class="fl">2010</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For this case, we update the setting <code>detrend_data = TRUE</code>
and we provide the <code>core_col_year = 2010</code> corresponding to
the year of the core collection. The linear_rate is required and is
included by setting <code>include_linear_rate = TRUE</code>.</p>
<p>The output of this function is a list of two dataframes called
<code>data</code> and <code>data_grid</code>. - The <code>data</code>
dataframe is the inputted data with additional columns for the
data_type_id which will contain “ProxyRecord”. It can be accessed
by:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input_detrend</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<ul>
<li>The <code>data_grid</code> is a dataframe that is evenly spaced in
time based on the <code>prediction_grid_res</code> value chosen by the
user and is used to create the plots and is accessed by</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grid</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input_detrend</span><span class="op">$</span><span class="va">data_grid</span></span></code></pre></div>
<p><strong>Step 1a:</strong> A brief insight into the outputs of the
<code>reslr_input</code> function can be obtained using:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">CedarIslandNC_input_detrend</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr input object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Decadally averaged tide gauge data was not included. It is recommended for the ni_gam_decomp model </span></span>
<span><span class="co">#&gt; The linear_rate and linear_rate_err has been included. </span></span>
<span><span class="co">#&gt; Data has been detrended.</span></span></code></pre></div>
<p><strong>Step 2:</strong> Plotting the data the raw data with:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">CedarIslandNC_input_detrend</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw detrended data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_vig/plotigpdata_adv-1.png" width="672" style="display: block; margin: auto;">
This will produce a plot of Age on the x-axis and Sea Level on the
y-axis in meters. Grey boxes represent the uncertainty associated with
the vertical and horizontal uncertainty. The black data points are the
midpoints of these uncertainty boxes. The extra arguments can be used
which allows the user to updated the titles and axis labels. The caption
<code>plot_caption</code>, included by default, provides the number of
proxy sites and tide gauge sites that will be used in the model and can
be removed if required <code>plot_caption = FALSE</code>. In addition,
the user can select to plot the additional tide gauge data,
<code>plot_tide_gauge = TRUE</code>.</p>
<p><strong>Step 3:</strong> To run the eiv_igp_t model the following
function should be used:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_igp_t_detrend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input_detrend</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_igp_t"</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This command takes the input data and the user specifies the
statistical model, i.e. an integrated Gaussian process using the EIV
uncertainty method (“eiv_igp_t”). It tells <code>reslr</code> to store
the output of the model run in an object called
<code>res_eiv_igp_t</code>. The <code>CI</code> setting allows the user
to set the credible intervals, the current default is
<code>CI = 0.95</code>.</p>
<p><strong>Step 3a:</strong> A brief insight into the outputs of the
<code>reslr_output</code> function can be obtained using:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_eiv_igp_t_detrend</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a valid reslr output object with 104 observations and  1 site(s).</span></span>
<span><span class="co">#&gt; There are  1  proxy site(s) and  0  tide gauge site(s).</span></span>
<span><span class="co">#&gt; The age units are; Common Era. </span></span>
<span><span class="co">#&gt; Model has used detrended data.</span></span>
<span><span class="co">#&gt; The model used was the Errors-in-Variables Integrated Gaussian Process model in time for detrended data.</span></span>
<span><span class="co">#&gt; The input data has been run via reslr_mcmc and has produced 3000 iterations over 3 MCMC chains.</span></span></code></pre></div>
<p><strong>Step 4:</strong> The convergence of the algorithm is examined
and he parameter estimates from the model can be investigated using the
following:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_eiv_igp_t_detrend</span><span class="op">)</span></span>
<span><span class="co">#&gt; No convergence issues detected.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 7</span></span></span>
<span><span class="co">#&gt;   variable    mean      sd     mad       q5    q95  rhat</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;num&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;num&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> nu       0.819   0.405   0.304   0.378    1.60    1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> rho      0.229   0.114   0.118   0.060<span style="text-decoration: underline;">8</span>   0.434   1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sigma_y  0.006<span style="text-decoration: underline;">24</span> 0.004<span style="text-decoration: underline;">82</span> 0.004<span style="text-decoration: underline;">59</span> 0.000<span style="text-decoration: underline;">498</span> 0.015<span style="text-decoration: underline;">5</span>  1.00</span></span></code></pre></div>
<p>If the model run has the package will print: “No convergence issues
detected”. If the package prints: “Convergence issues detected, a longer
run is necessary”. The user is required to update the
<code>reslr_mcmc</code> function with additional iterations in the
following manner:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_eiv_igp_t_detrend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">CedarIslandNC_input_detrend</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"eiv_igp_t"</span>,</span>
<span>  <span class="co"># Update these values</span></span>
<span>  n_iterations <span class="op">=</span> <span class="fl">6000</span>, <span class="co"># Number of iterations</span></span>
<span>  n_burnin <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of iterations to discard at the beginning</span></span>
<span>  n_thin <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Reduces number of output samples to save memory and computation time</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of Markov chains</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the parameter estimates, the length scale parameter, “rho” is the
correlation parameter and “nu” is the standard deviation of the rate
process. “sigma_y” is the variation of the model.</p>
<p><strong>Step 5:</strong> The results from the EIV IGP model for the
de-trended data can be illustrated using:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_eiv_igp_t_detrend</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"model_fit_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Sea Level (m)"</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_vig/plotigpres_adv-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The output of this function is a graph of the input data, i.e. Age
and SL and associated uncertainty boxes, and the model fit with 95 %
credible interval. The caption provides the model type used and number
of proxy sites and tide gauge sites used and can be removed if necessary
with <code>plot_caption = FALSE</code>. In order to view the rate of
change plot, the following setting should be used:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_eiv_igp_t_detrend</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"rate_plot"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  y_rate_lab <span class="op">=</span> <span class="st">"Rate of Change (mm per year)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_vig/plotigpresrate_adv-1.png" width="672" style="display: block; margin: auto;"></p>
<p>This prints the plot of the rate of change with 95 % credible
intervals. The caption provides the model type, the number of proxy
sites and tide gauge sites that were used.</p>
<p>To examine the data creating these plots the user types the
following:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_dataframes</span> <span class="op">&lt;-</span> <span class="va">res_eiv_igp_t_detrend</span><span class="op">$</span><span class="va">output_dataframes</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-a-different-input-age-unit">Using a different input age unit<a class="anchor" aria-label="anchor" href="#using-a-different-input-age-unit"></a>
</h2>
<p>The default input age for the reslr package is in units of years in
the Common Era. The user can select to input the age value in Before
Present by updating the <code>input_age_type = "BP"</code> within the
<code>reslr_load</code> function. Inside the package, the Age is
converted into CE in order to run the models. The plots are then altered
to account for the input age in BP and the x-axis is be reversed.</p>
<p>Load in the data using the <code>reslr_load</code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CedarIslandNC_input_age_BP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_age_bp</span>,</span>
<span>  input_age_type <span class="op">=</span> <span class="st">"BP"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output of this function is a list of two dataframes called
<code>data</code> and <code>data_grid</code>. Both dataframes will
contain two new columns which identify the <code>Age_type = "BP"</code>
and an additional column is included called <code>Age_BP</code> which
contains the original input Age in units Before Present.If the user is
recreating these plots, they are required to use the <code>Age_BP</code>
column along the x-axis as it provides the original input age in units
Before Present (BP) and the x-axis will need to be reversed.</p>
</div>
<div class="section level2">
<h2 id="including-tide-gauge-data">Including Tide Gauge data<a class="anchor" aria-label="anchor" href="#including-tide-gauge-data"></a>
</h2>
<p>In this package, we have described three ways to select a tide gauge
and in the example we showed how to include the closest tide gauge to
the proxy site. Here we are demonstrating the other options available to
the user.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For 2 site</span></span>
<span><span class="va">multi_site</span> <span class="op">&lt;-</span> <span class="va">NAACproxydata</span><span class="op">[</span><span class="va">NAACproxydata</span><span class="op">$</span><span class="va">Site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cedar Island"</span>, <span class="st">"Nassau"</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>If the user has a list of chosen tide gauges from PSMSL website,
include them in a list in the <code>reslr_load</code> function as
demonstrated:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multi_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">multi_site</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="co"># There is no limit to the number of tide gauges provided in the list</span></span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ARGENTIA"</span>, <span class="st">"MAYPORT"</span>,</span>
<span>    <span class="st">"JACKSONVILLE"</span>, <span class="st">"LAKE WORTH PIER"</span>,</span>
<span>    <span class="st">"MAYPORT (BAR PILOTS DOCK), FLORIDA"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  sediment_average_TG <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here is how to plot this example:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">multi_site</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_caption <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If the user requires all tide gauges within 1 degree of the proxy
site, which is the equivalent of 111kms, this can be done by updating
<code>all_TG_1deg=TRUE</code> in the following way:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multi_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">multi_site</span>,</span>
<span>  include_tide_gauge <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_linear_rate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TG_minimum_dist_proxy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_preferred_TGs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all_TG_1deg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prediction_grid_res <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here is how to plot this example:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">multi_site</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Plot of the raw data"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Year (CE)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Relative Sea Level (m)"</span>,</span>
<span>  plot_tide_gauges <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_proxy_records <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_caption <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting-techniques">Plotting techniques<a class="anchor" aria-label="anchor" href="#plotting-techniques"></a>
</h2>
<p>In the package, all plot labels for results, i.e. x and y labels and
titles, can be updated in the following manner:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example</span></span>
<span><span class="va">final_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span><span class="va">CedarIslandNC</span>, model_type <span class="op">=</span> <span class="st">"ni_spline_t"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">final_plots</span><span class="op">$</span><span class="va">plot_result</span></span>
<span><span class="co"># Adding new title to the total model fit plot</span></span>
<span><span class="va">final_plots</span><span class="op">$</span><span class="va">plot_result</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"New Title Added as Example"</span><span class="op">)</span></span>
<span><span class="va">final_plots</span><span class="op">$</span><span class="va">plot_result</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"New x axis label Added as Example"</span><span class="op">)</span></span>
<span><span class="va">final_plots</span><span class="op">$</span><span class="va">plot_result</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"New y axis label Added as Example"</span><span class="op">)</span></span></code></pre></div>
<p>The user can access the dataframes creating these plots in order to
recreate the output plots in their own style. To access the data frame
used to create the raw plot use:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">CedarIslandNC_input_detrend</span><span class="op">$</span><span class="va">data</span></span></code></pre></div>
<p>To access the dataframe creating the output model fit plot use:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">res_eiv_igp_t_detrend</span><span class="op">$</span><span class="va">output_dataframes</span></span></code></pre></div>
<p>This dataframes contains the model fit under the column
<code>pred</code> and the rate of change column is
<code>rate_pred</code>.</p>
<p>For the <code>ni_gam_decomp</code> model, there are a separate
dataframe for each component and the rate of change for each component
has a corresponding dataframe. This ensures the decomposition of the RSL
signal can be plotted with all four components together, using separate
colours to identify the different drivers of RSL change.</p>
</div>
<div class="section level2">
<h2 id="accessing-the-posterior-samples">Accessing the posterior samples<a class="anchor" aria-label="anchor" href="#accessing-the-posterior-samples"></a>
</h2>
<p>In the package the user has the ability access all the posterior
sample for each unknown parameter in the following way:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example</span></span>
<span><span class="va">CedarIslandNC_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reslr_load.html">reslr_load</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">CedarIslandNC</span><span class="op">)</span></span>
<span><span class="va">res_eiv_slr_t</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span>, </span>
<span>             model_type <span class="op">=</span> <span class="st">"eiv_slr_t"</span><span class="op">)</span></span>
<span><span class="co"># Accessing the slope of the EIV simple linear regression</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">res_eiv_slr_t</span><span class="op">$</span><span class="va">noisy_model_run_output</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">sims.list</span><span class="op">$</span><span class="va">beta</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="smoothing-settings-for-splines">Smoothing settings for splines<a class="anchor" aria-label="anchor" href="#smoothing-settings-for-splines"></a>
</h2>
<p>When constructing a spline piecewise polynomials join together at
knots to form smooth curves. The number of knots for these models can be
reduced to achieve a more smooth model fit or increased for more
flexibility. In the <code>reslr</code> package, tests have been carried
out to select the correct number of knots for the spline in time, spline
in space time and the GAM. However, if the situation arise where the
model fits require additional flexibility or require additional
smoothing, the user can adjust these settings. To adjust the setting for
the number of knots in the spline in time update the reslr function in
the following way:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_sp_t</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span>, </span>
<span>             model_type <span class="op">=</span> <span class="st">"ni_spline_t"</span>,</span>
<span>             spline_nseg <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>By updating the <code>spline_nseg</code> function, the number of
knots we change. Note the minimum value for this setting is 2. The
default for this setting is <code>NULL</code> as we use a rule of thumb
calculation to identify the number of knots based on the range of
observations. Similarly, for the spline in space time. The number of
knots is updated using:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_sp_t</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span>, </span>
<span>             model_type <span class="op">=</span> <span class="st">"ni_spline_st"</span>,</span>
<span>             spline_nseg <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>By updating the <code>spline_nseg</code> function, the number of
knots we change. Note the minimum value for this setting is 2. The
default for this setting is <code>NULL</code> as we use a rule of thumb
calculation to identify the number of knots based on the range of
observations.</p>
<p>When using the NI GAM approach, the number of knots for the separate
components can be altered. To control the smoothness of the regional
component (i.e. spline in time) the setting to vary is the
<code>spline_nseg_t</code>. To vary the non-linear local component
(i.e. spline in space time), the user can vary the
<code>spline_nseg_st</code> setting. The following example will
demonstrate these settings:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ni_sp_t</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/reslr_mcmc.html">reslr_mcmc</a></span><span class="op">(</span><span class="va">CedarIslandNC_input</span>, </span>
<span>             model_type <span class="op">=</span> <span class="st">"ni_gam_decomp"</span>,</span>
<span>             spline_nseg_t <span class="op">=</span> <span class="fl">20</span>,</span>
<span>             spline_nseg_st <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>The default settings have been tested using cross validation
techniques to incorporate the require flexibility for both
components.</p>
</div>
<div class="section level2">
<h2 id="cross-validation-tests-for-spline-and-ni-gam">Cross Validation tests for Spline and NI-GAM<a class="anchor" aria-label="anchor" href="#cross-validation-tests-for-spline-and-ni-gam"></a>
</h2>
<p>In the previous section, we discussed altering the smoothness of the
splines by varying the number of knots in the model. The user can test
the validity of the model and the number of knots selected using this
cross validation function with in the package. For example, the user can
run different values for the knots and compare the model fits for each
setting using the following cross validation function.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1site_example</span> <span class="op">&lt;-</span> <span class="va">NAACproxydata</span><span class="op">[</span><span class="va">NAACproxydata</span><span class="op">$</span><span class="va">Site</span> <span class="op">==</span> <span class="st">"Cedar Island"</span>,<span class="op">]</span></span>
<span><span class="co"># Cross Validation test</span></span>
<span><span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_val_check.html">cross_val_check</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data1site_example</span>,</span>
<span>                      model_type <span class="op">=</span><span class="st">"ni_spline_t"</span>,</span>
<span>                      n_iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                      n_burnin <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                      n_thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      n_chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                      spline_nseg <span class="op">=</span> <span class="cn">NULL</span>,<span class="co"># User the package to calculate the number of knots</span></span>
<span>                      <span class="co"># n_fold allows the user to alter the cross validation, i.e. 3, 5, 10 fold</span></span>
<span>                      n_fold <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                      <span class="co">#To reproducible results,seed stores the output of the random selection</span></span>
<span>                      seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                      CI <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="co"># Size of the credible intervals and prediction intervals</span></span></code></pre></div>
<p>To alter the number of knots in the model, include the
<code>spline_nseg</code> or <code>spline_nseg_t</code> or
<code>spline_nseg_st</code> arguments in this function. The different
meanings for these arguments are described in the section above. By
altering the <code>CI</code> argument, the user can change the size of
the prediction intervals.</p>
<p>The <code>n_fold = 3</code> argument allows the user to change the
number of folds used in the cross validation test. We recommend a
minimum of 3 folds and the ideal number of folds is 5 or 10, however,
using 10 folds will result in longer run times.</p>
<p>By updating the <code>model_type</code> argument, the user can
undertake cross validation for the noisy input spline in time, the noisy
input spline in space time or the noisy input generalised additive
model. This function will print a statement regarding model convergence.
If the convergence issues are detected, the package will inform the user
to increase the number of iterations in the <code>cross_val_check</code>
function.</p>
<p>The outputs of the <code>cross_val_check</code> function are stored
as a list. To examine the true versus predicted plot use the following
command.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv</span><span class="op">$</span><span class="va">true_pred_plot</span></span></code></pre></div>
<p><img src="advanced_vig/cvpredplot_adv-1.png" width="700"></p>
<p>This figure presents the true RSL value in metres versus the
predicted RSL value in metres for each data site. The predicted means
are the red dots and the vertical lines over each point are the
prediction intervals.</p>
<p>To access the dataframe creating this plot use:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CV_model_df</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">CV_model_df</span></span></code></pre></div>
<p>This dataframe contains the <code>true_RSL</code> values from the
test set and the corresponding predicted values <code>pred_RSL</code>.
In this dataframe, there are the prediction intervals
<code>upr_PI</code> and <code>lwr_PI</code>. The <code>SiteName</code>
column identifies each site present in the dataframe and allows for site
specific analysis of the model if required.</p>
<p>The model performance is examined using a variety of different test.
The first is the out of sample empirical coverage. The empirical
coverage provides the percentage of occasions that the true RSL
observation is within the model prediction interval (PI) for RSL and is
given by:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overall coverage</span></span>
<span><span class="va">total_empirical_coverage</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">total_coverage</span></span>
<span><span class="va">total_empirical_coverage</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co"># Coverage by site</span></span>
<span><span class="va">coverage_by_site</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">coverage_by_site</span></span>
<span><span class="va">coverage_by_site</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   SiteName                         coverage_by_site</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span>                1</span></span>
<span><span class="co"># Size of the prediction intervals</span></span>
<span><span class="va">prediction_interval_size</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">prediction_interval_size</span></span>
<span><span class="va">prediction_interval_size</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   SiteName                         PI_width</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span>   -<span style="color: #BB0000;">0.254</span></span></span></code></pre></div>
<p>The prediction intervals are created using posterior predictive
simulations with the full error structure, i.e. <span class="math inline">\(\hat{y}_{ij} \sim N(\hat{f}_{ij},
\sigma_{y_{ij}}^2 + \sigma_{{t}_{ij}}^2 + \sigma^2)\)</span> where <span class="math inline">\(\sigma_{y_{ij}}^2\)</span> is the observed
uncertainty associated with the RSL and <span class="math inline">\(\sigma_{{t}_{ij}}^2\)</span> is calculated to
account for the noisy input uncertainty associated with the input
(time). The size of these prediction intervals for each site can be
examined to understand how the coverage is calculated and using
different prediction intervals, e.g. 95% versus 50%, the model validity
can be further examined.</p>
<p>The remaining tools used to examine model performance within the
<code>reslr</code> package are the Root Mean Squared Error (RMSE), mean
error (ME) and mean absolute error (MAE). The RMSE provides insight into
prediction performance in the same units as the response (meters). The
RMSE can be examined by site or for each fold in the cross validation
test. The overall mean error (ME) by finding the difference between the
predicted observation and the true RSL observation. The mean absolute
error (MAE) is calculated by taking the absolute value of the mean
error, in turn, this provides the degree to which our model is biased.
For each test, the recommendation is the lower the value the better the
model fit and these values can be accessed by:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overall</span></span>
<span><span class="va">ME_MAE_RSME_overall</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">ME_MAE_RSME_overall</span></span>
<span><span class="va">ME_MAE_RSME_overall</span></span>
<span><span class="co">#&gt;         RSME        MAE           ME</span></span>
<span><span class="co">#&gt; 1 0.04694806 0.03833456 -0.004603636</span></span>
<span><span class="co"># By fold and site</span></span>
<span><span class="va">ME_MAE_RSME_fold_site</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">ME_MAE_RSME_fold_site</span></span>
<span><span class="va">ME_MAE_RSME_fold_site</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   SiteName                         CV_fold_number    RSME    MAE        ME</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> 1              0.004<span style="text-decoration: underline;">06</span> 0.027<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">686</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> 2              0.045<span style="text-decoration: underline;">5</span>  0.035<span style="text-decoration: underline;">4</span> -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">81</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> 3              0.032<span style="text-decoration: underline;">0</span>  0.052<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">41</span></span></span>
<span><span class="co"># By site</span></span>
<span><span class="va">ME_MAE_RSME_site</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">ME_MAE_RSME_site</span></span>
<span><span class="va">ME_MAE_RSME_site</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   SiteName                           RSME    MAE       ME</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>Cedar Island,\n North Carolina<span style="color: #949494;">"</span> 0.046<span style="text-decoration: underline;">9</span> 0.038<span style="text-decoration: underline;">3</span> -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">60</span></span></span>
<span><span class="co"># By fold</span></span>
<span><span class="va">ME_MAE_RSME_fold</span> <span class="op">&lt;-</span> <span class="va">cv</span><span class="op">$</span><span class="va">ME_MAE_RSME_fold</span></span>
<span><span class="va">ME_MAE_RSME_fold</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   CV_fold_number    RSME    MAE        ME</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1              0.004<span style="text-decoration: underline;">06</span> 0.027<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">686</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2              0.045<span style="text-decoration: underline;">5</span>  0.035<span style="text-decoration: underline;">4</span> -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">81</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3              0.032<span style="text-decoration: underline;">0</span>  0.052<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">41</span></span></span></code></pre></div>
<p>For more information about the outputs to these cross validation
tests for RSL data refer to Upton et al. 2023 paper.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maeve Upton, Andrew Parnell, Niamh Cahill.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
